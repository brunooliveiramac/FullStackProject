/*
  filename: angular.integralui.treegrid.min.js
  version : 2.3.019
  Copyright © 2014-2015 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUITreeGridService",["$rootScope",function(c){var d=null;return{addColumn:function(l,n){c.$broadcast(l+"-add-column",n)},clearColumns:function(l){c.$broadcast(l+"-clear-columns")},insertColumnAt:function(l,n,d){c.$broadcast(l+"-insert-column-at",n,d)},insertColumnBefore:function(l,n,d){c.$broadcast(l+"-insert-column-before",n,d)},insertColumnAfter:function(l,n,d){c.$broadcast(l+"-insert-column-after",n,d)},removeColumn:function(l,n){c.$broadcast(l+"-remove-column",
n)},removeColumnAt:function(l,n){c.$broadcast(l+"-remove-column-at",n)},addRow:function(l,n,d){c.$broadcast(l+"-add-row",n,d)},clearRows:function(l,n){c.$broadcast(l+"-clear-rows",n)},insertRowAt:function(l,n,d,f){c.$broadcast(l+"-insert-row-at",n,d,f)},insertRowBefore:function(l,n,d){c.$broadcast(l+"-insert-row-before",n,d)},insertRowAfter:function(l,n,d){c.$broadcast(l+"-insert-row-after",n,d)},removeRow:function(l,n){c.$broadcast(l+"-remove-row",n)},removeRowAt:function(l,n,d){c.$broadcast(l+"-remove-row-at",
n,d)},exportToJSON:function(l,n,d,f,R){c.$broadcast(l+"-export-json",n,d,f,R);l=this.getTempData();this.clearTempData();return l?l:""},loadData:function(l,n,d,f,R){c.$broadcast(l+"-load-data",n,d,f,R)},openEditor:function(l,n){c.$broadcast(l+"-open-editor",n)},closeEditor:function(l,n){c.$broadcast(l+"-close-editor",n)},collapse:function(l,n){c.$broadcast(l+"-collapse",n)},expand:function(l,n){c.$broadcast(l+"-expand",n)},expandColIndex:function(l,n){c.$broadcast(l+"-expand-col-index",n)},toggle:function(l,
n){c.$broadcast(l+"-toggle",n)},filter:function(l,n,d){c.$broadcast(l+"-filter",n,d)},findRowById:function(l,n){c.$broadcast(l+"-find-row-by-id",n);var d=this.getTempData();this.clearTempData();return d?d:null},findRowByPath:function(l,n,d){c.$broadcast(l+"-find-row-by-path",n,d);l=this.getTempData();this.clearTempData();return l?l:null},findRowByText:function(l,n){c.$broadcast(l+"-find-row-by-text",n);var d=this.getTempData();this.clearTempData();return d?d:null},getRowParent:function(l,n){c.$broadcast(l+
"-get-row-parent",n);var d=this.getTempData();this.clearTempData();return d?d:null},focus:function(l,d){c.$broadcast(l+"-focus",d)},clearTempData:function(){d=null},ensureVisible:function(l,d){c.$broadcast(l+"-ensure-visible",d)},getTempData:function(){return d},getRowLevel:function(l,d){c.$broadcast(l+"-get-row-level",d);var u=this.getTempData();this.clearTempData();return u?u:0},getFlatList:function(l,d){c.$broadcast(l+"-get-flat-list",d);var u=this.getTempData();this.clearTempData();return u?u:
[]},getFullPath:function(l,d){c.$broadcast(l+"-get-full-path",d);var u=this.getTempData();this.clearTempData();return u?u:""},getHoverColumn:function(l,d){c.$broadcast(l+"-get-hover-column",d);var u=this.getTempData();this.clearTempData();return u?u:null},getList:function(l,d){c.$broadcast(l+"-get-list",d);var u=this.getTempData();this.clearTempData();return u?u:[]},setTempData:function(c){d=c},topRow:function(l,d){if(d)c.$broadcast(l+"-set-top-row",d);else return c.$broadcast(l+"-get-top-row"),d=
this.getTempData(),this.clearTempData(),d?d:null},beginLoad:function(l,d,u){c.$broadcast(l+"-begin-load",d,u)},endLoad:function(l,d){c.$broadcast(l+"-end-load",d)},moveColumn:function(l,d,u){c.$broadcast(l+"-move-column",d,u)},moveRow:function(d,n,u,f,R){c.$broadcast(d+"-move-row",n,u,f,R)},getScrollPos:function(d){c.$broadcast(d+"-get-scroll-pos");d=this.getTempData();this.clearTempData();return d?d:{x:0,y:0}},getMaxScrollPos:function(d){c.$broadcast(d+"-get-max-scroll-pos");d=this.getTempData();
this.clearTempData();return d?d:{x:0,y:0}},setScrollPos:function(d,n){c.$broadcast(d+"-set-scroll-pos",n)},scrollTo:function(d,n,u){c.$broadcast(d+"-scroll-to",n,u)},clearSelection:function(d){c.$broadcast(d+"-clear-selection")},selectedColumn:function(d,n){if(n)c.$broadcast(d+"-set-selected-column",n);else{c.$broadcast(d+"-get-selected-column");var u=this.getTempData();this.clearTempData();return u?u:null}},selectedRow:function(d,n){if(n)c.$broadcast(d+"-set-selected-row",n);else{c.$broadcast(d+
"-get-selected-row");var u=this.getTempData();this.clearTempData();return u?u:null}},selectedRows:function(d){c.$broadcast(d+"-get-selected-rows");d=this.getTempData();this.clearTempData();return d?d:null},sort:function(d,n,u,f){c.$broadcast(d+"-sort",n,u,f)},refresh:function(d,n,u){c.$broadcast(d+"-refresh",n,u)},resumeLayout:function(d){c.$broadcast(d+"-resume-layout")},suspendLayout:function(d){c.$broadcast(d+"-suspend-layout")},updateLayout:function(d){c.$broadcast(d+"-update-layout")},updateView:function(d){c.$broadcast(d+
"-update-view")}}}]).controller("IntegralUITreeGridController",["$scope","$element","$timeout","$window","$interval","IntegralUIInternalService","IntegralUIDataService","IntegralUITreeGridService","IntegralUIDragDrop","IntegralUIFilter",function(c,d,l,n,u,f,R,g,p,Nb){var a=this;this.suppressProcess=!1;this.hoverCell=this.hoverRow=this.hoverColumn=null;a.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",
indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};a.defaultStyle={general:"iui-treegrid",column:{general:{content:"iui-treegrid-column-cell-content",disabled:"iui-treegrid-column-disabled",normal:"iui-treegrid-column",hovered:"iui-treegrid-column-hovered",selected:"iui-treegrid-column-selected"},header:{content:"iui-treegrid-column-header-cell-content",disabled:"iui-treegrid-column-header-disabled",normal:"iui-treegrid-column-header",hovered:"iui-treegrid-column-header-hovered",
selected:"iui-treegrid-column-header-selected"},body:{content:"iui-treegrid-column-body-cell-content",disabled:"iui-treegrid-column-body-disabled",normal:"iui-treegrid-column-body",hovered:"iui-treegrid-column-body-hovered",selected:"iui-treegrid-column-body-selected"},footer:{content:"iui-treegrid-column-footer-cell-content",disabled:"iui-treegrid-column-footer-disabled",normal:"iui-treegrid-column-footer",hovered:"iui-treegrid-column-footer-hovered",selected:"iui-treegrid-column-footer-selected"}},
row:{general:{disabled:"iui-treegrid-row-disabled",focused:"iui-treegrid-row-focused",normal:"iui-treegrid-row",hovered:"iui-treegrid-row-hovered",selected:"iui-treegrid-row-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},expandBox:{general:"iui-treegrid-expand-box",animated:"iui-treegrid-expand-box-load",expanded:"iui-treegrid-expand-box-open",
collapsed:"iui-treegrid-expand-box-close"},cell:{content:"iui-treegrid-row-cell-content",general:"iui-treegrid-row-cell",disabled:"iui-treegrid-row-cell-disabled",focused:"iui-treegrid-row-cell-focused",normal:"iui-treegrid-row-cell",hovered:"iui-treegrid-row-cell-hovered",selected:"iui-treegrid-row-cell-selected"}},cell:{content:"iui-treegrid-row-cell-content",general:"iui-treegrid-row-cell",disabled:"iui-treegrid-row-cell-disabled",focused:"iui-treegrid-row-cell-focused",normal:"iui-treegrid-row-cell",
hovered:"iui-treegrid-row-cell-hovered",selected:"iui-treegrid-row-cell-selected"}};this.updateOptions=function(b){b?(a.options={allowAnimation:f.isFieldAvailable(b.allowAnimation,!0),allowCellFocus:f.isFieldAvailable(b.allowCellFocus,!0),allowColumnReorder:f.isFieldAvailable(b.allowColumnReorder,!1),allowDrag:f.isFieldAvailable(b.allowDrag,!1),allowDrop:f.isFieldAvailable(b.allowDrop,!0),allowFilter:f.isFieldAvailable(b.allowFilter,!1),allowFocus:f.isFieldAvailable(b.allowFocus,!0),animationSpeed:200,
autoExpand:f.isFieldAvailable(b.autoExpand,!0),controlStyle:a.defaultStyle,editorSettings:{activate:"click"},expandColIndex:f.isFieldAvailable(b.expandColIndex,void 0!=a.options.expandColIndex?a.options.expandColIndex:0),fillSpace:f.isFieldAvailable(b.fillSpace,!1),gridLines:f.isFieldAvailable(b.gridLines,"both"),hoverSelection:f.isFieldAvailable(b.hoverSelection,!1),indent:f.isFieldAvailable(b.indent,15),labelEdit:f.isFieldAvailable(b.labelEdit,!1),loadRows:[],pathSeparator:f.isFieldAvailable(b.pathSeparator,
"\\"),rtl:f.isFieldAvailable(b.rtl,!1),selectedColumn:f.isFieldAvailable(b.selectedColumn,a.options.selectedColumn?a.options.selectedColumn:null),selectedIndex:-1,selectedRow:f.isFieldAvailable(b.selectedRow,a.options.selectedRow?a.options.selectedRow:null),selectedRows:a.options.selectedRows?a.options.selectedRows:[],selectionMode:f.isFieldAvailable(b.selectionMode,"one"),showFooter:f.isFieldAvailable(b.showFooter,!0),showHeader:f.isFieldAvailable(b.showHeader,!0),showIcons:f.isFieldAvailable(b.showIcons,
!0),sorting:f.isFieldAvailable(b.sorting,"none")},a.updateDataFields(b.dataFields),a.updateControlStyle(b.controlStyle)):(a.options={allowAnimation:!0,allowCellFocus:!0,allowColumnReorder:!1,allowDrag:!1,allowDrop:!0,allowFilter:!1,allowFocus:!0,animationSpeed:200,autoExpand:!0,controlStyle:a.defaultStyle,editorSettings:{activate:"click"},expandColIndex:0,fillSpace:!1,gridLines:"both",hoverSelection:!1,indent:15,labelEdit:!1,loadRows:[],pathSeparator:"\\",rtl:!1,selectedColumn:null,selectedIndex:-1,
selectedRow:null,selectedRows:[],selectionMode:"one",showFooter:!0,showHeader:!0,showIcons:!0,sorting:"none"},a.updateDataFields())};a.options={};this.updateColumnFields=function(b){a.options.columnFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFilter:b.allowFilter?b.allowFilter:"allowFilter",comparer:b.comparer?b.comparer:"comparer",contentAlignment:b.contentAlignment?b.contentAlignment:"contentAlignment",contextMenu:b.contextMenu?b.contextMenu:
"contextMenu",editorType:b.editorType?b.editorType:"editorType",editorSettings:b.editorSettings?b.editorSettings:"editorSettings",editorTemplate:b.editorTemplate?b.editorTemplate:"editorTemplate",filterParams:b.filterParams?b.filterParams:"filterParams",filterTemplate:b.filterTemplate?b.filterTemplate:"filterTemplate",fixed:b.fixed?b.fixed:"fixed",fixedWidth:b.fixedWidth?b.fixedWidth:"fixedWidth",footerAlignment:b.footerAlignment?b.footerAlignment:"footerAlignment",footerContent:b.footerContent?b.footerContent:
"footerContent",footerTemplate:b.footerTemplate?b.footerTemplate:"footerTemplate",footerTemplateModel:b.footerTemplateModel?b.footerTemplateModel:"footerTemplateModel",footerText:b.footerText?b.footerText:"footerText",headerAlignment:b.headerAlignment?b.headerAlignment:"headerAlignment",headerContent:b.headerContent?b.headerContent:"headerContent",headerTemplate:b.headerTemplate?b.headerTemplate:"headerTemplate",headerTemplateModel:b.headerTemplateModel?b.headerTemplateModel:"headerTemplateModel",
headerText:b.headerText?b.headerText:"headerText",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",minWidth:b.minWidth?b.minWidth:"minWidth",maxWidth:b.maxWidth?b.maxWidth:"maxWidth",style:b.style?b.style:"style",visible:b.visible?b.visible:"visible",width:b.width?b.width:"width"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFilter:"allowFilter",comparer:"comparer",contentAlignment:"contentAlignment",contextMenu:"contextMenu",editorType:"editorType",editorSettings:"editorSettings",editorTemplate:"editorTemplate",
filterParams:"filterParams",filterTemplate:"filterTemplate",footerTemplateModel:"footerTemplateModel",fixed:"fixed",fixedWidth:"fixedWidth",footerAlignment:"footerAlignment",footerContent:"footerContent",footerTemplate:"footerTemplate",footerText:"footerText",headerAlignment:"headerAlignment",headerContent:"headerContent",headerTemplate:"headerTemplate",headerTemplateModel:"headerTemplateModel",headerText:"headerText",icon:"icon",id:"id",minWidth:"minWidth",maxWidth:"maxWidth",style:"style",visible:"visible",
width:"width"};a.columnsObj&&a.columnsObj.updateDataFields(a.options.columnFields)};this.updateRowFields=function(b){a.options.rowFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFocus:b.allowFocus?b.allowFocus:"allowFocus",cells:b.cells?b.cells:"cells",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",expanded:b.expanded?b.expanded:"expanded",hasChildren:b.hasChildren?
b.hasChildren:"hasChildren",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",pid:b.pid?b.pid:"pid",rows:b.rows?b.rows:"rows",statusIcon:b.statusIcon?b.statusIcon:"statusIcon",style:b.style?b.style:"style",text:b.text?b.text:"text"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFocus:"allowFocus",cells:"cells",content:"content",contextMenu:"contextMenu",enabled:"enabled",expanded:"expanded",hasChildren:"hasChildren",icon:"icon",id:"id",pid:"pid",rows:"rows",statusIcon:"statusIcon",style:"style",text:"text"};
a.rowsObj&&a.rowsObj.updateDataFields(a.options.rowFields)};this.updateCellFields=function(b){a.options.cellFields=b?{allowEdit:b.allowEdit?b.allowEdit:"allowEdit",cid:b.cid?b.cid:"cid",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",labelEdit:b.labelEdit?b.labelEdit:"labelEdit",rid:b.rid?b.rid:"rid",style:b.style?b.style:"style",text:b.text?b.text:"text",value:b.value?b.value:"value"}:{allowEdit:"allowEdit",cid:"cid",
content:"content",contextMenu:"contextMenu",enabled:"enabled",labelEdit:"labelEdit",rid:"rid",style:"style",text:"text",value:"value"}};this.updateDataFields=function(b){b?(a.updateColumnFields(b.column),a.updateRowFields(b.row),a.updateCellFields(b.cell)):(a.updateColumnFields(),a.updateRowFields(),a.updateCellFields())};a.updateOptions();c.$on(c.name+"-add-column",function(b,e){a.columnsObj.insertAt(e,-1,null,a.columnIsAdded)});c.$on(c.name+"-clear-columns",function(b){a.columnsObj.clear(null,a.columnsAreCleared)});
c.$on(c.name+"-insert-column-at",function(b,e,c){a.columnsObj.insertAt(e,c,null,a.columnIsAdded)});c.$on(c.name+"-insert-column-after",function(b,e,c){a.columnsObj.insertByRef(e,c,!0,a.columnIsAdded)});c.$on(c.name+"-insert-column-before",function(b,e,c){a.columnsObj.insertByRef(e,c,!1,a.columnIsAdded)});c.$on(c.name+"-remove-column",function(b,e){a.columnsObj.removeAt(e,-1,null,a.columnIsRemoved)});c.$on(c.name+"-remove-column-at",function(b,e){a.columnsObj.removeAt(null,e,null,a.columnIsRemoved)});
this.columnsAreCleared=function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=!1);a.options.selectedColumn=null;a.updateLayout()};a.columnIsAdded=function(){a.updateLayout()};a.columnIsRemoved=function(b,e){a.updateLayout()};c.$on(c.name+"-add-row",function(b,e,c){a.rowsObj.insertAt(e,-1,c,a.rowIsAdded)});c.$on(c.name+"-clear-rows",function(b,e){a.rowsObj.clear(e,a.rowsAreCleared)});c.$on(c.name+"-insert-row-at",function(b,e,c,k){a.rowsObj.insertAt(e,c,k,a.rowIsAdded)});c.$on(c.name+
"-insert-row-after",function(b,e,c){a.rowsObj.insertByRef(e,c,!0,a.rowIsAdded)});c.$on(c.name+"-insert-row-before",function(b,e,c){a.rowsObj.insertByRef(e,c,!1,a.rowIsAdded)});c.$on(c.name+"-remove-row",function(b,e){a.rowsObj.removeAt(e,-1,null,a.rowIsRemoved)});c.$on(c.name+"-remove-row-at",function(b,e,c){a.rowsObj.removeAt(null,e,c,a.rowIsRemoved)});this.rowsAreCleared=function(b){b||(a.clearPrevSelection(),a.options.selectedRow=null,a.setScrollPos({x:0,y:0}));a.updateCurrentLayout()};this.rowIsAdded=
function(){a.updateCurrentLayout()};this.rowIsRemoved=function(b,e,c){a.updateCurrentLayout()};this.objIsRemoved=function(b,e,c){a.updateCurrentLayout()};a.columnList=[];a.columnFilterList=[];a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;this.updateColumnList=function(){a.columnList.length=0;a.columnFilterList.length=0;a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;var b=a.columnsObj.getList();if(b)for(var e=0;e<b.length;e++){var c=b[e];c.type="column";c[a.options.columnFields.id]||
(c[a.options.columnFields.id]=f.getUniqueId());if(0!=c[a.options.columnFields.visible]){var k=c[a.options.columnFields.filterParams],k=k?Nb.createTree(k.conditions,k.formula):null;a.columnFilterList.push({cid:c[a.options.columnFields.id],tree:k});a.columnList.push(c);switch(c[a.options.columnFields.fixed]){case "left":a.isThereLeftFixedColumns||(a.isThereLeftFixedColumns=!0);break;case "right":a.isThereRightFixedColumns||(a.isThereRightFixedColumns=!0)}}}};var fc=function(b){for(var e=null,c=0;c<
a.columnFilterList.length;c++)if(a.columnFilterList[c].cid==b){e=a.columnFilterList[c].tree;break}return e},C=function(b,e){if(0==a.options.allowFilter)return!0;var c=!0;if(b){for(var k=-1,d=null,f=null,g=0;g<b[a.options.rowFields.cells].length&&(c=!0,f=b[a.options.rowFields.cells][g],k=f[a.options.cellFields.cid],d=a.getColumnById(k),!d&&g<a.columnList.length&&(d=a.columnList[g]),d&&d[a.options.columnFields.filterParams]&&(c=d[a.options.columnFields.filterParams],d=f[a.options.cellFields.value]?
f[a.options.cellFields.value]:f[a.options.cellFields.text],c=c.callback?c.callback(d,f,b):Nb.match(d,c.conditions,c.formula,fc(k))),c);g++);if(c&&(e||a.isRowExpanded(b))&&(k=b[a.options.rowFields.rows])&&0<k.length){for(g=f=0;g<k.length;g++)(childPass=C(k[g],e))&&f++;0==f&&(c=!1)}}return c},X=a.options.indent;a.currentList=[];a.indentList=[];a.longestRow=null;a.isThereChildRows=!1;this.isThereVisibleChildren=function(b){var e=!1;if(b&&(b=b[a.options.rowFields.rows])&&0<b.length)for(var c=0;c<b.length;c++)if(C(b[c])){e=
!0;break}return e};var G=function(b,e,c,k){b.type="row";b[a.options.rowFields.id]||(b[a.options.rowFields.id]=f.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var d=b[a.options.rowFields.cells];if(d&&0<d.length){c=C(b,k);a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&(c=c&&a.isThereVisibleChildren(b));for(var g=-1,l="label",n=null,n=null,p=0;p<a.columnList.length;p++){var n=a.columnList[p],g=n[a.options.columnFields.id],l=n[a.options.columnFields.editorType],
n=n[a.options.columnFields.editorSettings],u=p;g&&(u=a.getCellIndexById(d,p,g));0<=u&&u<d.length&&(d[u].type="cell",d[u][a.options.cellFields.rid]=b[a.options.rowFields.id],a.setDefaultCellValue(d[u],l,n))}}c&&(k?a.fullList.push(b):(a.currentList.push(b),a.indentList.push(e)));return c},w=function(b,e,c,k){var d=!0;if(!b[a.options.rowFields.rows])return d=G(b,e,c,k);if(d=G(b,e,c,k)){c=0;var f=!0;if(k||a.isRowExpanded(b)){var g=b[a.options.rowFields.rows];if(g){a.applySorting(g);for(var l=0;l<g.length;l++)(f=
w(g[l],e+X,b[a.options.rowFields.id],k))&&c++}}k||a.isThereChildRows||!(0<c||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))||(a.isThereChildRows=!0)}return d};a.fullList=[];this.getFullList=function(){a.fullList.length=0;for(var b=a.rowsObj.getList(),e=0;e<b.length;e++)w(b[e],0,null,!0);return a.fullList};this.getCurrentList=function(){return a.currentList};this.updateCurrentList=function(){a.currentList.length=0;a.indentList.length=
0;a.isThereChildRows=!1;X=a.options.indent;var b=a.rowsObj.getList();if(b){a.applySorting(b);for(var e=0;e<b.length;e++)w(b[e],0,null,!1)}};this.columnEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearColumns?c.events.clearColumns({parent:a.e.parent}):c.clearColumns(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.columnAdded?c.events.columnAdded({column:a.e.column}):c.columnAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?
c.events.columnAdding({column:a.e.column}):c.columnAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.columnRemoved({column:a.e.column}):c.columnRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.columnRemoving({column:a.e.column}):c.columnRemoving(a)}};this.rowEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearRows?c.events.clearRows({parent:a.e.parent}):c.clearRows(a)},objAdded:function(a){return angular.isDefined(c.events)&&
c.events.rowAdded?c.events.rowAdded({row:a.e.row}):c.rowAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?c.events.rowAdding({row:a.e.row}):c.rowAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.rowRemoved({row:a.e.row}):c.rowRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.rowRemoving({row:a.e.row}):c.rowRemoving(a)}};this.getRowFields=function(a){return{content:a.content?
a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",pid:a.pid?a.pid:"pid",objects:a.rows?a.rows:"rows",subobjects:a.cells?a.cells:"cells",text:a.text?a.text:"text"}};a.columnsObj=new R({objects:c.columns,events:a.columnEvents,fields:a.options.columnFields});a.rowsObj=new R({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});c.$on(c.name+"-load-data",function(b,e,c,k,d){a.loadData(e,c,k,d)});c.$on(c.name+"-export-json",function(b,e,c,k,d){g.setTempData(a.exportToJSON(e,
c,k,d))});this.exportToJSON=function(b,e,c,k){var d=k,d=d?d:null,f=a.columnsObj.getList();b=JSON.stringify(f,b?b:[a.options.columnFields.allowDrag,a.options.columnFields.allowDrop,a.options.columnFields.allowFilter,a.options.columnFields.contentAlignment,a.options.columnFields.contextMenu,a.options.columnFields.editorType,a.options.columnFields.editorSettings,a.options.columnFields.editorTemplate,a.options.columnFields.filterParams,a.options.columnFields.filterTemplate,a.options.columnFields.fixed,
a.options.columnFields.fixedWidth,a.options.columnFields.footerAlignment,a.options.columnFields.footerContent,a.options.columnFields.footerTemplate,a.options.columnFields.footerText,a.options.columnFields.headerAlignment,a.options.columnFields.headerContent,a.options.columnFields.headerTemplate,a.options.columnFields.headerText,a.options.columnFields.icon,a.options.columnFields.id,a.options.columnFields.style,a.options.columnFields.visible,a.options.columnFields.width],d);k=k?k:null;d=!1!==c?a.getFullList():
a.rowsObj.getList();e=e?e:[a.options.rowFields.allowCellFocus,a.options.rowFields.allowDrag,a.options.rowFields.allowDrop,a.options.rowFields.allowFocus,a.options.rowFields.cells,a.options.rowFields.content,a.options.rowFields.contextMenu,a.options.rowFields.enabled,a.options.rowFields.expanded,a.options.rowFields.hasChildren,a.options.rowFields.icon,a.options.rowFields.id,a.options.rowFields.pid,a.options.rowFields.statusIcon,a.options.rowFields.style,a.options.rowFields.text,a.options.cellFields.rid];
0==c&&e.push(a.options.rowFields.rows);c=JSON.stringify(d,e,k);return'[\n{ "columns": '+b+' },\n{ "rows": '+c+" }\n]"};this.loadData=function(b,e,fa,k){a.suspendLayout();a.updateDataFields(fa);var d=[],f=a.options.rowFields;a.rowsObj.clear(e,a.rowsAreCleared);if(b)if(!1!==k){var g=[];b.forEach(function(a,b){var e=a[f.pid];g[e]?(g[e][f.rows]||(g[e][f.rows]=[]),g[a[f.id]]=a,g[e][f.rows].push(a)):(g[a[f.id]]=a,d.push(a))});g.length=0}else d=b;if(e)for(e[a.options.rowFields.rows]=d,b=0;b<e[a.options.rowFields.rows].length;b++)e[a.options.rowFields.rows][b][a.options.rowFields.pid]=
e[a.options.rowFields.id];else if(angular.isDefined(c.rows))for(b=c.rows.length=0;b<d.length;b++)c.rows.push(d[b]);a.rowsObj=new R({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});a.resumeLayout()};this.updateData=function(){a.options.rowFields.dataSource&&(a.loadData(a.options.rowFields.dataSource),a.rowsObj=new R({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)}))};var ta=!1;this.dragDropStatus=function(a){if(void 0!=a)ta=a;else return ta};
this.getDnDSource=function(a){return{text:a.dataTransfer?a.dataTransfer.getData("text"):a.originalEvent.dataTransfer?a.originalEvent.dataTransfer.getData("text"):""}};this.getTouchData=function(a){return a.changedTouches?a.changedTouches:a.originalEvent?a.originalEvent.changedTouches:null};var Ba=angular.element('<div class="iui-drop-marker" data-element="dropmark"></div>');this.getDropMarkLine=function(){return dropMarkLine};angular.element(n).bind("dragenter",function(b){a.dropMark()});angular.element(n).bind("dragend",
function(b){a.removeDropMark();a.dragIcon&&angular.element(a.dragIcon).remove();a.cancelScrollTimer();a.dragDropStatus(!1)});a.getMousePos=function(a){return{x:a.pageX?a.pageX:a.originalEvent?a.originalEvent.pageX:0,y:a.pageY?a.pageY:a.originalEvent?a.originalEvent.pageY:0}};this.getTreeName=function(){return angular.isDefined(c.name)?c.name:""};d.bind("dragenter",function(b){b.preventDefault();var e=p.getData();e.source||(e.source=a.getDnDSource(b));b={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getTreeName():
"",dragRow:e.source,targetTree:a.getTreeName(),targetRow:e.target,mousePos:a.getMousePos(b)};a.callDragEnter(b)});d.bind("dragover",function(b){b.preventDefault();if(a.isDropInRange(b)){var e=!0;b.dataTransfer?e="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(e="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(e)if(b.dataTransfer?b.dataTransfer.dropEffect=a.options.allowDrop?"move":"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=
a.options.allowDrop?"move":"none"),e=p.getData(),e.source||(e.source=a.getDnDSource(b)),p.setData({source:e.source,sourceCtrl:e.sourceCtrl,target:null,dropPos:-1}),e={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getTreeName():"",dragRow:e.source,targetTree:a.getTreeName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)},0==a.callDragOver(e))b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=
"none"),a.dropMark();else{e=a.getMousePos(b);b=e.y+16;var e=e.x+20,fa=a.getDropMarkWindow();fa.empty();fa.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(c.name?c.name:"TreeGrid")+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:e});a.dropMark(!0)}}else a.dropMark(),b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none")});d.bind("drop",function(b){b.preventDefault();
a.dropMark();if(a.isDropInRange(b)){var e=!0;b.dataTransfer?e="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(e="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(e&&(e=p.getData(),e.source||(e.source=a.getDnDSource(b)),e.source)){var fa={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getTreeName():"",dragRow:e.source,targetTree:a.getTreeName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)};!1!==a.callDragDrop(fa)&&
(a.drop(e),c.$$phase||c.$apply())}}p.clearData();b.stopPropagation()});d.bind("dragleave",function(b){b.preventDefault();a.dropMark();var e=p.getData();e.source||(e.source=a.getDnDSource(b));b={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getTreeName():"",dragRow:e.source,targetTree:a.getTreeName(),targetRow:e.target,mousePos:a.getMousePos(b)};a.callDragLeave(b);a.cancelScrollTimer()});d.bind("dragend",function(b){b.preventDefault();a.dropMark();p.getData().source||p.clearData();a.dragDropStatus(!1)});
d.bind("mouseleave",function(b){b.preventDefault();a.dropMark();a.hoverColumn=null;a.hoverRow=null;a.hoverCell=null});this.containsMousePos=function(a,e){return p.hitTest(a,e,{left:0,top:0,right:d[0].clientWidth,bottom:d[0].clientHeight})};this.isPopupActive=function(){return!1};var ua=function(b,e){var c=a.options.rowFields;if(!b[c.cells]){b[c.cells]=[];var k={};k[a.options.cellFields.text]=b[e.text];b[c.cells].push(k)}b[c.rows]||(b[c.rows]=[]);b[c.rows].length=0;if(b[e.items]&&0<b[e.items].length)for(k=
0;k<b[e.items].length;k++)b[c.rows].push(ua(b[e.items][k],e));return b},va=function(b,e){var c=!1;e.sourceCtrl&&(c=e.sourceCollection.removeAt(b,-1,null,e.sourceCtrl.objIsRemoved));c&&("item"==b.type&&(b=ua(b,e.sourceCtrl.options.dataFields)),0===e.dropPos?a.rowsObj.insertAt(b,-1,e.target,a.rowIsAdded):1===e.dropPos||2===e.dropPos?1===e.dropPos?a.rowsObj.insertByRef(b,e.target,!1,a.rowIsAdded):a.rowsObj.insertByRef(b,e.target,!0,a.rowIsAdded):a.rowsObj.insertAt(b,-1,null,a.rowIsAdded))};this.setDropSelection=
function(b,e){var c=b;!c&&0<=e&&e<a.currentList.length&&(c=a.currentList[e]);a.clearPrevSelection(c);a.rowSelection(c)};this.drop=function(b){if(b&&b.sourceCtrl){b.sourceCtrl.suppressProcess=!0;a.allowUpdate=!1;b.sourceCtrl.allowUpdate=!1;var e=b.source,c=-1;if(Array.isArray(b.source)){0<b.source.length&&(c=b.sourceCtrl.getObjCurrentIndex(b.source[b.source.length-1]));for(var k=[],d=0;d<b.source.length;d++){for(var f=!1,g=b.sourceCollection.getParent(b.source[d]);g;){if(b.sourceCtrl.isObjInSelList(g)){f=
!0;break}g=b.sourceCollection.getParent(g)}f||k.push(b.source[d])}if(0<k.length)if(e=k[k.length-1],d=b.sourceCtrl.getObjCurrentIndex(k[0]),f=b.sourceCtrl.getObjCurrentIndex(e),d<=f)for(d=0;d<k.length;d++)va(k[d],b);else for(d=k.length-1;0<=d;d--)va(k[d],b)}else c=b.sourceCtrl.getObjCurrentIndex(b.source),va(b.source,b);b.sourceCtrl!==a?(a.allowUpdate=!0,b.sourceCtrl.allowUpdate=!0,a.updateCurrentLayout(),b.sourceCtrl.updateCurrentLayout()):(a.allowUpdate=!0,a.updateCurrentLayout());b.sourceCtrl.multiSelection(!1);
var n=l(function(){b.sourceCtrl!==a&&b.sourceCtrl.setDropSelection(null,c);a.setDropSelection(e);a.updateFocus(a.getObjCurrentIndex(e),0);l.cancel(n)},1);b.sourceCtrl.suppressProcess=!1}};this.isDragAllowed=function(b){return a.options.allowDrag?b&&(b[a.options.rowFields.allowDrag]||void 0===b[a.options.rowFields.allowDrag])?!0:!1:!1};this.isChildOf=function(b,e){var c=!1;if(b&&e){var k=e[a.options.rowFields.rows];if(k&&0<k.length)for(var d=0;d<k.length;d++){if(f.isEqual(b[a.options.rowFields.id],
k[d][a.options.rowFields.id])){c=!0;break}else c=a.isChildOf(b,k[d]);if(c)break}}return c};this.isParentOf=function(b,e){var c=a.rowsObj.getParent(e);return b&&e&&c&&f.isEqual(b[a.options.rowFields.id],c[a.options.rowFields.id])?!0:!1};this.isDropAllowed=function(b,e,c){var k=a.options.allowDrop;if(k&&b&&e&&(k=e[a.options.rowFields.allowDrop]||void 0===e[a.options.rowFields.allowDrop]?!0:!1))if(Array.isArray(b))for(var d=0;d<b.length;d++){if(f.isEqual(b[d][a.options.rowFields.id],e[a.options.rowFields.id])||
0===c&&a.isParentOf(e,b[d])||a.isChildOf(e,b[d])){k=!1;break}if(!k)break}else if(f.isEqual(b[a.options.rowFields.id],e[a.options.rowFields.id])||0===c&&a.isParentOf(e,b)||a.isChildOf(e,b))k=!1;return k};this.getDropMarkWindow=function(){for(var a=Ba,e=angular.element(document.body).children(),c=0;c<e.length;c++){var d=angular.element(e[c]);if(d[0].attributes&&d[0].attributes["data-element"]&&"dropmark"===d[0].attributes["data-element"].value){a=d;break}}return a};this.dropMark=function(b,e){e||(e=
a.getDropMarkWindow());if(e){var c="none";this.options.allowDrop&&(c=b?"block":"none");angular.element(e).css("display",c)}};this.updateDropMarkElem=function(a,e){a&&e&&(a.css("top",e.top+"px"),a.css("left",e.left+"px"),a.css("width",e.width+"px"))};c.$on(c.name+"-open-editor",function(b,e){a.openEditor(e)});c.$on(c.name+"-close-editor",function(b,e){a.closeEditor(e)});this.updateEditorSettings=function(b){a.options.editorSettings=b?{activate:f.isFieldAvailable(b.activate,"click")}:{activate:"click"}};
this.allowEvents=!0;this.callAfterCollapse=function(a){angular.isDefined(c.events)&&c.events.afterCollapse&&c.events.afterCollapse({row:a});c.afterCollapse({e:{row:a}})};this.callAfterExpand=function(a){angular.isDefined(c.events)&&c.events.afterExpand&&c.events.afterExpand({row:a});c.afterExpand({e:{row:a}})};this.callAfterEdit=function(a){angular.isDefined(c.events)&&c.events.afterEdit&&c.events.afterEdit({cell:a});c.afterEdit({e:{cell:a}})};this.callAfterLabelEdit=function(a){angular.isDefined(c.events)&&
c.events.afterLabelEdit&&c.events.afterLabelEdit({cell:a});c.afterLabelEdit({e:{cell:a}})};this.callAfterSelect=function(a){angular.isDefined(c.events)&&c.events.afterSelect?c.events.afterSelect({object:a}):c.afterSelect({e:{object:a}});angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({object:a}):c.selectionChanged({e:{object:a}})};this.callBeforeCollapse=function(a){var e=!0;return e=angular.isDefined(c.events)&&c.events.beforeCollapse?c.events.beforeCollapse({row:a}):
c.beforeCollapse({e:{row:a}})};this.callBeforeExpand=function(a){var e=!0;return e=angular.isDefined(c.events)&&c.events.beforeExpand?c.events.beforeExpand({row:a}):c.beforeExpand({e:{row:a}})};this.callBeforeEdit=function(a){var e=!0;return e=angular.isDefined(c.events)&&c.events.beforeEdit?c.events.beforeEdit({cell:a}):c.beforeEdit({e:{cell:a}})};this.callBeforeLabelEdit=function(a){var e=!0;return e=angular.isDefined(c.events)&&c.events.beforeLabelEdit?c.events.beforeLabelEdit({cell:a}):c.beforeLabelEdit({e:{cell:a}})};
this.callCellValueChanging=function(b,e,d){var k=!0;a.allowEvents&&(k=angular.isDefined(c.events)&&c.events.cellvalueChanging?c.events.cellvalueChanging({row:b,cell:e,value:d}):c.cellvalueChanging({e:{row:b,cell:e,value:d}}));return k};this.callCellValueChanged=function(b,e,d){a.allowEvents&&(angular.isDefined(c.events)&&c.events.cellvalueChanged?c.events.cellvalueChanged({row:b,cell:e,value:d}):c.cellvalueChanged({e:{row:b,cell:e,value:d}}))};this.callChange=function(){angular.isDefined(c.events)&&
c.events.change?c.events.change():c.change()};this.callColumnClick=function(a,e){angular.isDefined(c.events)&&c.events.columnClick&&c.events.columnClick({column:a,mousePos:e});c.columnClick({e:{column:a,mousePos:e}})};this.callColumnDblClick=function(a,e){angular.isDefined(c.events)&&c.events.columnDblclick&&c.events.columnDblclick({column:a,mousePos:e});c.columnDblclick({e:{column:a,mousePos:e}})};this.callColumnHover=function(a){angular.isDefined(c.events)&&c.events.columnHover&&c.events.columnHover({column:a});
c.columnHover({e:{column:a}})};this.callColumnPosChanging=function(a,e){var d=!0;return d=angular.isDefined(c.events)&&c.events.columnPoschanging?c.events.columnPoschanging({sourceColumn:a,targetColumn:e}):c.columnPoschanging({e:{sourceColumn:a,targetColumn:e}})};this.callColumnPosChanged=function(a,e){angular.isDefined(c.events)&&c.events.columnPoschanged&&c.events.columnPoschanged({sourceColumn:a,targetColumn:e});c.columnPoschanged({e:{sourceColumn:a,targetColumn:e}})};this.callColumnRightClick=
function(a,e){angular.isDefined(c.events)&&c.events.columnRightclick&&c.events.columnRightclick({column:a,mousePos:e});c.columnRightclick({e:{column:a,mousePos:e}})};this.callColumnSizeChanged=function(a,e){angular.isDefined(c.events)&&c.events.columnSizechanged&&c.events.columnSizechanged({column:a});c.columnSizechanged({e:{column:a}})};this.callDragEnter=function(a){angular.isDefined(c.events)&&c.events.dragEnter?c.events.dragEnter({event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,
targetRow:a.targetRow,mousePos:a.mousePos}):c.dragEnter({e:{event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callDragOver=function(a){var e=!0;return e=angular.isDefined(c.events)&&c.events.dragOver?c.events.dragOver({event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}):c.dragOver({e:{event:a.event,
sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}})};this.callDragDrop=function(a){var e=!0;return e=angular.isDefined(c.events)&&c.events.dragDrop?c.events.dragDrop({event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}):c.dragDrop({e:{event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,
targetTree:a.targetTree,targetRow:a.targetRow,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}})};this.callDragLeave=function(a){angular.isDefined(c.events)&&c.events.dragLeave?c.events.dragLeave({event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,mousePos:a.mousePos}):c.dragLeave({e:{event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callCellClick=
function(a,e,d,k){angular.isDefined(c.events)&&c.events.cellClick&&c.events.cellClick({event:a,row:e,cell:d,mousePos:k});c.cellClick({e:{event:a,row:e,cell:d,mousePos:k}})};this.callCellHover=function(a,e){angular.isDefined(c.events)&&c.events.cellHover?c.events.cellHover({event:a,cell:e}):c.cellHover({e:{event:a,cell:e}})};this.callRowClick=function(a,e,d){angular.isDefined(c.events)&&c.events.rowClick?c.events.rowClick({event:a,row:e,mousePos:d}):c.rowClick({e:{event:a,row:e,mousePos:d}})};this.callRowDblClick=
function(a,e){var d=!0;return d=angular.isDefined(c.events)&&c.events.rowDblClick?c.events.rowDblClick({row:a,mousePos:e}):c.rowDblclick({e:{row:a,mousePos:e}})};this.callRowHover=function(a,e){angular.isDefined(c.events)&&c.events.rowHover?c.events.rowHover({event:a,row:e}):c.rowHover({e:{event:a,row:e}})};this.callRowRightClick=function(a,e){angular.isDefined(c.events)&&c.events.rowRightClick&&c.events.rowRightClick({row:a,mousePos:e});c.rowRightclick({e:{row:a,mousePos:e}})};this.callKeyDown=function(a,
e){angular.isDefined(c.events)&&c.events.keyDown?c.events.keyDown({event:a,row:e}):c.keyDown({e:{event:a,row:e}})};this.callKeyPress=function(a,e){angular.isDefined(c.events)&&c.events.keyPress?c.events.keyPress({event:a,row:e}):c.keyPress({e:{event:a,row:e}})};this.callKeyUp=function(a,e){angular.isDefined(c.events)&&c.events.keyUp?c.events.keyUp({event:a,row:e}):c.keyUp({e:{event:a,row:e}})};this.callScrollPosChanged=function(){angular.isDefined(c.events)&&c.events.scrollPosChanged?c.events.scrollPosChanged({scrollPos:a.scrollPos}):
c.scrollposChanged({e:{scrollPos:a.scrollPos}})};d.bind("click",function(b){1===b.which&&a.callRowClick(b,null,a.getMousePos(b))});d.bind("dblclick",function(b){b.preventDefault();1===b.which&&a.callRowDblClick(null,a.getMousePos(b));b.stopPropagation()});d.bind("mousedown",function(b){3===b.which&&a.callRowRightClick(null,a.getMousePos(b));a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b.stopPropagation()});this.expandList=[];this.expandIndentList=[];var gb=function(b,e,c){b.type="row";
b[a.options.rowFields.id]||(b[a.options.rowFields.id]=f.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var d=b[a.options.rowFields.cells];if(d&&0<d.length){c=C(b);a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&(c=c&&a.isThereVisibleChildren(b));for(var g=-1,l="label",n=null,n=null,p=0;p<a.columnList.length;p++){var n=a.columnList[p],g=n[a.options.columnFields.id],l=n[a.options.columnFields.editorType],n=n[a.options.columnFields.editorSettings],u=p;g&&
(u=a.getCellIndexById(d,p,g));0<=u&&u<d.length&&(d[u].type="cell",a.setDefaultCellValue(d[u],l,n))}}c&&(a.expandList.push(b),a.expandIndentList.push(e));return c},y=function(b,e,c){var d=!0;if(!b[a.options.rowFields.rows])return d=gb(b,e+X,c);if(d=gb(b,e+X,c)){c=0;var g=!0;if(a.isRowExpanded(b)){var f=b[a.options.rowFields.rows];if(f){a.applySorting(f);for(var l=0;l<f.length;l++)(g=y(f[l],e+X,b[a.options.rowFields.id]))&&c++}}!a.isThereChildRows&&(0<c||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&
0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(a.isThereChildRows=!0)}return d};this.expand=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(!a.isRowExpanded(b)){var e=a.getRowCurrentIndex(b);if(b=a.getList(b)){a.applySorting(b);for(var c=0;c<b.length;c++)y(b[c],a.indentList[e],null)}if(0<a.expandList.length){a.allowEvents=!1;e++;Array.prototype.splice.apply(a.currentList,[e,0].concat(a.expandList));Array.prototype.splice.apply(a.indentList,[e,0].concat(a.expandIndentList));
a.getRowScope()?a.updateView():a.updateLayout();var d=l(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();l.cancel(d);a.allowEvents=!0},1)}}};this.collapse=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(a.isRowExpanded(b)){var e=null,c=!1,d=b,f=-1,g=a.getRowCurrentIndex(b);for(b=a.getParent(b);b&&!c;){e=a.getList(b);for(f=e.indexOf(d)+1;!c&&f<e.length;)d=e[f],0<a.getRowCurrentIndex(d)&&(c=!0),f++;c||(d=b);b=a.getParent(b)}if(!c&&d)for(e=a.getList(),f=e.indexOf(d)+
1;f<e.length;)if(d=e[f],0<a.getRowCurrentIndex(d)){c=!0;break}else f++;g++;e=a.currentList.length-g;c&&(e=a.getRowCurrentIndex(d)-g);if(0<e){a.currentList.splice(g,e);a.indentList.splice(g,e);a.getRowScope()?a.updateView():a.updateLayout();var n=l(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();l.cancel(n);a.allowEvents=!0},1)}}};this.toggle=function(b,e){if(b){if(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0!=b[a.options.rowFields.rows].length)if(!e||0==
b[a.options.rowFields.expanded])if(!1!==e||0!=b[a.options.rowFields.expanded]){a.updateType="view";var c=void 0!==e?e:!1!==b[a.options.rowFields.expanded]?!0:!1,d=!0,d=void 0!==e?e?a.callBeforeExpand(b):a.callBeforeCollapse(b):c?a.callBeforeCollapse(b):a.callBeforeExpand(b);!1!==d&&(c=void 0!=e?e:!c,c!=b[a.options.rowFields.expanded]&&(0!=c?a.expand(b):a.collapse(b),b[a.options.rowFields.expanded]=c),a.isRowExpanded(b)?a.callAfterExpand(b):a.callAfterCollapse(b))}}else{c=a.getFullList();for(d=0;d<
c.length;d++)c[d][a.options.rowFields.expanded]=e;a.updateCurrentLayout()}};c.$on(c.name+"-collapse",function(b,e){a.toggle(e,!1)});c.$on(c.name+"-expand",function(b,e){a.toggle(e,!0)});c.$on(c.name+"-expand-col-index",function(b,e){0<=e&&e<a.columnList.length&&(a.options.expandColIndex=e)});c.$on(c.name+"-toggle",function(b,e){a.toggle(e)});this.isFilteringAllowed=function(b){return b&&b[a.options.columnFields.allowFilter]};c.$on(c.name+"-filter",function(b,e,c){a.filter(e,c)});this.filter=function(b,
e){if(b)b[a.options.columnFields.filterParams]=e;else for(var c=0;c<a.columnList.length;c++)b[a.options.columnFields.filterParams]=null;a.closeFilterWindow();a.updateCurrentLayout();a.callChange()};this.callGotFocus=function(a,e,d,k,f){angular.isDefined(c.events)&&c.events.gotFocus?c.events.gotFocus({event:a,row:e,cell:d,edit:void 0!=k?!0:!1,editValue:f}):c.gotFocus({e:{event:a,row:e,cell:d,edit:void 0!=k?!0:!1,editValue:f}})};this.callLostFocus=function(a,e,d,k,f){angular.isDefined(c.events)&&c.events.lostFocus?
c.events.lostFocus({event:a,row:e,cell:d,edit:void 0!=k?!0:!1,editValue:f}):c.lostFocus({e:{event:a,row:e,cell:d,edit:void 0!=k?!0:!1,editValue:f}})};this.getTabIndex=function(){return d[0].attributes&&d[0].attributes.tabindex?d[0].attributes.tabindex.value:""};this.updateFocus=function(b,e){if(1==a.options.allowFocus)var c=l(function(){if(a.isRowIndexInRange(b)){var k="none";0<=e&&e<a.columnList.length&&(k=a.columnList[e][a.options.columnFields.fixed]);var f=a.getElemFromRow(a.currentList[b],k);
f&&(1==a.options.allowCellFocus&&0<=e&&e<a.columnList.length?(k=a.getElemFromCell(b,e,k))&&k[0].focus():f[0].focus())}else d[0].focus();l.cancel(c)},5)};c.$on(c.name+"-focus",function(b,e){if(e){var c=-1,d=-1;switch(e.type){case "row":c=a.getRowCurrentIndex(e);a.updateFocus(c);break;case "cell":c=a.getCellRowIndex(e),d=a.getCellColumnIndex(e),a.updateFocus(c,d)}}else a.updateFocus()});var Sa=!1;this.getCell=function(b,e){if(0<=b&&b<a.currentList.length){var c=a.currentList[b],d=a.getColumnRealIndex(e);
0<=e&&e<a.columnList.length&&(d=a.getCellIndexById(c[a.options.rowFields.cells],e,a.columnList[e].id));if(c[a.options.rowFields.cells]&&0<=d&&d<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][d]}return null};this.getCellObject=function(b,e){if(0<=b&&b<a.currentList.length){var c=a.currentList[b],d=a.getColumnRealIndex(e);0<=e&&e<a.columnList.length&&(d=a.getCellIndexById(c[a.options.rowFields.cells],e,a.columnList[e].id));if(c[a.options.rowFields.cells]&&0<=d&&d<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][d]}return null};
this.getCellIndexById=function(b,c,d){var k=-1;if(b){c=a.getColumnRealIndex(c);for(var f=0;f<b.length;f++)if(void 0==b[f][a.options.cellFields.cid]){k=c;break}else if(b[f][a.options.cellFields.cid]==d){k=f;break}}return k};this.getCellIndexFromRow=function(b,c){var d=-1;if(b&&c&&c[a.options.rowFields.cells])for(var k=0;k<c[a.options.rowFields.cells].length;k++)if(c[a.options.rowFields.cells][k]==b){d=k;break}return d};this.getCellColumnIndex=function(b){if(b)if(b[a.options.cellFields.cid]){if(b=a.getColumnById(b[a.options.cellFields.cid]))return a.getColumnCurrentIndex(b)}else return a.getCellColumnIndexFromRow(b);
return-1};this.getCellColumnIndexFromRow=function(b){if(b&&b[a.options.cellFields.rid]){var c=a.findRowById(b[a.options.cellFields.rid]);if(c&&(c=c[a.options.rowFields.cells])&&0<c.length)return c.indexOf(b)}return-1};this.getCellRowIndex=function(b){return b&&b[a.options.cellFields.rid]&&(b=a.findRowById(b[a.options.cellFields.rid]))?a.getRowCurrentIndex(b):-1};this.getColumnById=function(b){for(var c=null,d=0;d<a.columnList.length;d++)if(a.columnList[d][a.options.columnFields.id]==b){c=a.columnList[d];
break}return c};this.getColumnObject=function(b){return 0<=b&&b<a.columnList.length?a.columnList[b]:null};this.getRowObject=function(b){return 0<=b&&b<a.currentList.length?a.currentList[b]:null};this.isRowExpanded=function(b){return b?b[a.options.rowFields.expanded]||void 0===b[a.options.rowFields.expanded]?!0:!1:!0};this.getContentElement=function(a,c){var d=null;c||(c="cell-content");if(a&&0<a.children().length)for(var k=a.children(),f=0;f<k.length;f++){var g=angular.element(k.eq(f));if(g[0].attributes&&
g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==c){d=g;break}}return d};this.getElement=function(a,c){var d=null;c||(c="cell-content");if(a&&0<a.children().length){a=a.children().eq(0);for(var k=a.children(),f=0;f<k.length;f++){var g=angular.element(k.eq(f));if(g[0].attributes&&g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==c){d=g;break}}}return d};this.getChildElement=function(a,c){var d=null;c||(c="content");if(a&&0<a.children().length)for(var k=
a.children(),f=0;f<k.length;f++){var g=angular.element(k.eq(f));if(g[0].attributes&&g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==c){d=g;break}}return d};this.getElemFromColumn=function(b,c,d){var k=null;if(b){b=a.getColumnCurrentIndex(b);var f=a.getHeaderElem(c);"footer"==d&&(f=a.getFooterElem(c));if(f&&(c=f.find("td"))&&0<c.length)for(d=0;d<c.length;d++)if(f=angular.element(c[d]),f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===b.toString()){k=
f;break}}return k};this.getElemFromRow=function(b,c){var d=null;if(b){var k=a.getRowCurrentIndex(b),f=a.getRowElems(c);if(f&&0<f.length)for(var g=0;g<f.length;g++){var l=angular.element(f[g]);if(l[0].attributes["data-index"]&&l[0].attributes["data-index"].value.toString()===k.toString()){d=l;break}}}return d};this.getElemFromCell=function(b,c,d){var k=null;if(0<=b&&b<a.currentList.length&&(b=a.getElemFromRow(a.currentList[b],d))&&(b=b.find("td"))&&0<b.length)for(d=0;d<b.length;d++){var f=angular.element(b[d]);
if(f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===c.toString()){k=f;break}}return k};this.getElemFromColumnCell=function(b,c,d){var k=null,f=null;if((f=d?a.getFooterElem(c):a.getHeaderElem(c))&&(c=f.find("td"))&&0<c.length)for(d=0;d<c.length;d++)if(f=angular.element(c[d]),f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===b.toString()){k=f;break}return k};this.getIndent=function(b){var c=0;if(b)for(parent=a.rowsObj.getParent(b);parent;)c+=
a.options.indent,parent=a.rowsObj.getParent(parent);return c};this.getObjState=function(b){if(b)switch(b.type){case "column":if(1==b.selected)return"selected";if(b==a.hoverColumn)return"hovered";break;case "row":if(0==b[a.options.rowFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverRow)return"hovered";break;case "cell":if(0==b[a.options.cellFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverCell)return"hovered"}return"normal"};this.getColumnAt=
function(b,c){if(void 0==b||void 0==c)return a.hoverColumn;for(var d=null,k=null,g=null,d="left",l=0;!g&&3>l;){if(d=a.getHeaderElem(d)){var n=d.find("td");if(n&&0<n.length)for(var p=0;p<n.length;p++)if(d=angular.element(n[p]),k=f.getPageRect(d),f.checkHit(b,c,k)){g=a.getColumnFromElem(d);break}}l++;d=1==l?"right":"none"}return g};this.getRowAt=function(b,c){for(var d=null,k=null,g=null,d="none",l=0;!g&&3>l;){var n=a.getRowElems(d);if(n&&0<n.length)for(var p=0;p<n.length;p++)if(d=angular.element(n[p]),
k=f.getPageRect(d),f.checkHit(b,c,k)){g=a.getRowFromElem(d);break}l++;d=1==l?"left":"right"}return g};this.getRowCurrentIndex=function(b){return b&&a.currentList?a.currentList.indexOf(b):-1};this.getObjCurrentIndex=function(b){return a.getRowCurrentIndex(b)};this.getRowFromChildElem=function(b){if(b&&(b=angular.element(b))){for(b=b.parent();b&&b[0].tagName&&"tr"!==b[0].tagName.toLowerCase();)b=b.parent();return b?a.getRowFromElem(b):null}return null};this.getColumnCurrentIndex=function(b){return b&&
a.columnList?a.columnList.indexOf(b):-1};this.getColumnRealIndex=function(b){var c=a.columnsObj.getList();return 0<=b&&b<c.length&&b<a.columnList.length?c.indexOf(a.columnList[b]):-1};this.getColumnFromChildElem=function(b){return b?a.getColumnFromElem(b):null};this.getColumnFromElem=function(b){return b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,0<=b&&b<a.columnList.length)?a.columnList[b]:null};this.getIndexFromElem=function(a){return a&&(a=angular.element(a))&&
a[0].attributes["data-index"]?a[0].attributes["data-index"].value:-1};this.getRowFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,a.isRowIndexInRange(b)))return a.currentList[b]};this.isRowIndexInRange=function(b){return 0<=b&&b<a.currentList.length};this.isColIndexInRange=function(b){return 0<=b&&b<a.columnList.length};this.isRowEnabled=function(b){return b&&f.isEnabled(b[a.options.rowFields.enabled])};this.mouseButtonStatus=
function(a){Sa=a};c.$on(c.name+"-ensure-visible",function(b,c){a.ensureVisible(c)});c.$on(c.name+"-find-row-by-id",function(b,c){g.setTempData(a.findRowById(c))});c.$on(c.name+"-find-row-by-path",function(b,c,d){g.setTempData(a.findRowByPath(c,d))});c.$on(c.name+"-find-row-by-text",function(b,c){g.setTempData(a.findRowByText(c))});c.$on(c.name+"-get-full-path",function(b,c){g.setTempData(a.getFullPath(c))});c.$on(c.name+"-get-row-level",function(b,c){g.setTempData(a.getLevel(c))});c.$on(c.name+"-get-row-parent",
function(b,c){g.setTempData(a.getParent(c))});c.$on(c.name+"-get-flat-list",function(b,c){c?g.setTempData(a.getFullList()):g.setTempData(a.currentList)});c.$on(c.name+"-get-list",function(b,c){g.setTempData(a.getList(c))});c.$on(c.name+"-get-top-row",function(b){g.setTempData(a.getTopRow())});c.$on(c.name+"-set-top-row",function(b,c){a.ensureVisible(c)});this.ensureVisible=function(b,c){if(b){for(var d=[],f=a.getParent(b);f;)d.push(f),f=a.getParent(f);for(f=d.length-1;0<=f;f--)d[f][a.options.rowFields.expanded]=
!0;a.updateCurrentLayout();var g=l(function(){c=void 0!=c?c:"center";a.scrollTo(b,c);l.cancel(g)},100)}};this.findRowById=function(b){return a.rowsObj.findObjectById(b)};this.findRowByText=function(b){return a.rowsObj.findObjectByText(b)};this.findRowByPath=function(b,c){var d=null;c||(c=a.getFullList());for(var f=0;f<c.length;f++)if(a.getFullPath(c[f])==b){d=c[f];break}return d};this.getFullPath=function(b){var c="";if(b)for(c=b[a.options.rowFields.text],b=a.getParent(b);b;)c=[b[a.options.rowFields.text],
a.options.pathSeparator,c].join(""),b=a.getParent(b);return c};this.getLevel=function(a){var c=0;for(a=this.getParent(a);a;)c++,a=this.getParent(a);return c};this.getParent=function(b){return a.rowsObj.getParent(b)};this.getList=function(b){return a.rowsObj.getList(b)};this.getFirstRow=function(){for(var b=null,c=0;c<a.currentList.length;c++)if(f.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.getPrevRow=function(b){var c=null;if(0<=b&&b<a.currentList.length)for(--b;0<=
b;b--)if(f.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getNextRow=function(b){var c=null;for(b+=1;b<a.currentList.length;b++)if(f.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getLastRow=function(){for(var b=null,c=a.currentList.length-1;0<=c;c--)if(f.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.updateSelectionStatus=function(b){switch(b){case "shift":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);
break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}break;case "ctrl":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}}};d.bind("keydown",function(b){switch(b.keyCode){case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}});
this.allowUpdate=!0;this.updateType="all";this.suspendLayout=function(){a.allowUpdate=!1};this.resumeLayout=function(){a.allowUpdate=!0;a.updateLayout()};c.$on(c.name+"-refresh",function(b,c,d){a.refresh(c,d)});c.$on(c.name+"-resume-layout",function(b){a.resumeLayout()});c.$on(c.name+"-suspend-layout",function(b){a.suspendLayout()});c.$on(c.name+"-update-layout",function(b){a.updateLayout()});c.$on(c.name+"-update-view",function(b){a.updateView()});c.$on(c.name+"-begin-load",function(b,c,d){c?(0>
a.options.loadRows.indexOf(c)&&a.options.loadRows.push(c),a.updateView()):a.beginLoad(d)});c.$on(c.name+"-end-load",function(b,c){a.endLoad(c)});this.callLoadComplete=function(a){angular.isDefined(c.events)&&c.events.loadComplete?c.events.loadComplete():c.loadComplete()};this.callUpdateComplete=function(){angular.isDefined(c.events)&&c.events.updateComplete?c.events.updateComplete():c.updateComplete()};c.$on(c.name+"-get-max-scroll-pos",function(b){g.setTempData(a.getMaxScrollPos())});c.$on(c.name+
"-get-scroll-pos",function(b){g.setTempData(a.getScrollPos())});c.$on(c.name+"-set-scroll-pos",function(b,c){a.setScrollPos(c)});c.$on(c.name+"-scroll-to",function(b,c,d){a.scrollTo(c,d)});var na=!1;this.multiSelection=function(a){if(void 0!=a)na=a;else return na};this.columnSelection=function(b,e){if(b){var d=!0;a.options.selectedColumn&&(d=!f.isEqual(a.options.selectedColumn[a.options.columnFields.id],b[a.options.columnFields.id]));var k=!0,k=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):
c.beforeSelect({e:{object:b}});d&&!1!==k&&(a.options.selectedColumn&&(a.options.selectedColumn.selected=!1,a.refresh(a.options.selectedColumn)),a.options.selectedColumn=b,b.selected=!0,angular.isDefined(c.selectedColumn)&&(c.selectedColumn=b),a.refresh(a.options.selectedColumn),a.callAfterSelect(b))}else return a.options.selectedColumn};this.isRowSelected=function(a){return f.isSelected(a)};this.clearPrevSelection=function(b){for(var c=0;c<a.options.selectedRows.length;c++)b&&!f.isEqual(a.options.selectedRows[c][a.options.rowFields.id],
b[a.options.rowFields.id])?a.options.selectedRows[c].selected=!1:b||(a.options.selectedRows[c].selected=!1);a.options.selectedRows.length=0;b&&0!=b[a.options.rowFields.enabled]&&a.options.selectedRows.push(b);a.refreshRows()};this.markSelColumn=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b])};this.rowSelection=function(b,e,d,k){if(b){if("none"!=a.options.selectionMode)if(a.isRowEnabled(b)){d=a.rowSelection();var g=!0;d&&(g=!f.isEqual(d[a.options.rowFields.id],b[a.options.rowFields.id]));
var l=!0,l=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});if(!1!==l)if(g){g=!0;"multi-extended"==a.options.selectionMode&&(g=!a.isObjInSelList(b));g&&(Sa&&e?a.clearPrevSelection():na||"multi-simple"===a.options.selectionMode||a.clearPrevSelection());a.options.selectedRow=b;if(Sa&&e&&"one"!=a.options.selectionMode){if(e=a.getRowCurrentIndex(d),k=a.getRowCurrentIndex(b),e>k&&(d=e,e=k,k=d),a.isRowIndexInRange(e)&&a.isRowIndexInRange(k))for(;e<=
k;e++)a.currentList[e].selected=!0,a.options.selectedRows.push(a.currentList[e])}else Sa&&(na||"multi-simple"===a.options.selectionMode)?(e=null===b.selected||"undefined"===b.selected?!1:b.selected,b.selected=!e,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b})):(b.selected=!0,a.isObjInSelList(b)||a.options.selectedRows.push(b));angular.isDefined(c.selectedRow)&&(c.selectedRow=b);a.callAfterSelect(b);a.refresh(null,
null,!0)}else if(na||"multi-simple"===a.options.selectionMode)e=null===b.selected||"undefined"===b.selected?!1:b.selected,k&&"undefined"!==k&&(e=k),b.selected=!e,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b}),a.callAfterSelect(b),a.refresh(null,null,!0)}else a.clearPrevSelection()}else return a.options.selectedRow};this.updateSelection=function(b,c){"multi-extended"==a.options.selectionMode&&0<a.options.selectedRows.length&&
!c&&!na&&(a.clearPrevSelection(b),a.refresh(null,null,!0))};this.isObjInSelList=function(b){var c=!1,d=a.options.selectedRows;if(b&&d)for(var k=0;k<d.length;k++)if(f.isEqual(d[k][a.options.rowFields.id],b[a.options.rowFields.id])){c=!0;break}return c};this.markSelRows=function(){var b=a.getRowElems();if(b&&0<b.length)for(var c=0;c<b.length;c++){var d=a.getRowFromElem(b[c]);d&&a.refresh(d)}};c.$on(c.name+"-clear-selection",function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=!1);
a.options.selectedColumn=null;a.clearPrevSelection();a.options.selectedRow=null});c.$on(c.name+"-get-hover-column",function(b,c){a.hoverColumn?g.setTempData(a.hoverColumn):c&&g.setTempData(a.getColumnAt({x:c.x,y:c.y}))});c.$on(c.name+"-get-selected-column",function(b){g.setTempData(a.columnSelection())});c.$on(c.name+"-set-selected-column",function(b,c){a.columnSelection(c)});c.$on(c.name+"-get-selected-row",function(b){g.setTempData(a.rowSelection())});c.$on(c.name+"-set-selected-row",function(b,
c){var d=l(function(){a.rowSelection(c);l.cancel(d)},1)});c.$on(c.name+"-get-selected-rows",function(b){g.setTempData(a.options.selectedRows)});c.$on(c.name+"-move-column",function(b,c,d){a.moveColumn(c,d)});c.$on(c.name+"-move-row",function(b,c,d,f,g){a.moveRow(c,d,f,g)});c.$watch("options",function(b,c){b!==c&&(a.updateOptions(b),a.updateLayout())},!0);c.$watch("allowCellFocus",function(b,c){b!==c&&(a.options.allowCellFocus=b)});c.$watch("allowColumnReorder",function(b,c){b!==c&&(a.options.allowColumnReorder=
b)});c.$watch("allowFilter",function(b,c){b!==c&&(a.options.allowFilter=b)});c.$watch("allowFocus",function(b,c){b!==c&&(a.options.allowFocus=b)});c.$watch("allowDrag",function(b,c){b!==c&&(a.options.allowDrag=b,a.updateView())});c.$watch("allowDrop",function(b,c){b!==c&&(a.options.allowDrop=b,a.updateView())});c.$watch("autoExpand",function(b,c){b!==c&&(a.options.autoExpand=b)});c.$watch("controlStyle",function(b,c){b!==c&&a.updateControlStyle(b)});c.$watch("editorSettings",function(b,c){b!==c&&
a.updateEditorSettings(b)});c.$watch("expandingColumnIndex",function(b,c){b!==c&&(a.options.expandColIndex=b)});c.$watch("fields",function(b,c){b!==c&&(a.updateDataFields(b),a.UpdateData())});c.$watch("fillSpace",function(b,c){b!==c&&(a.options.fillSpace=b)});c.$watch("gridLines",function(b,c){b!==c&&(a.options.gridLines=b,a.updateView())});c.$watch("hoverSelection",function(b,c){b!==c&&(a.options.hoverSelection=b)});c.$watch("indent",function(b,c){b!==c&&(a.options.indent=b,a.updateLayout())});c.$watch("rowIcon",
function(b,c){b!==c&&(a.options.rowIcon=b,a.updateLayout())});c.$watch("labelEdit",function(b,c){b!==c&&(a.options.labelEdit=b)});c.$watch("pathSeparator",function(b,c){b!==c&&(a.options.pathSeparator=b)});c.$watch("rtl",function(b,c){b!==c&&(a.options.rtl=b,a.updateLayout())});a.resetSelection=function(){switch(a.options.selectionMode){case "none":a.clearPrevSelection();break;default:a.clearPrevSelection(a.rowSelection())}};c.$watch("selectionMode",function(b,c){b!==c&&(a.options.selectionMode=b,
a.resetSelection())});c.$watch("showFooter",function(b,c){b!==c&&(a.options.showFooter=b,a.updateLayout())});c.$watch("showHeader",function(b,c){b!==c&&(a.options.showHeader=b,a.updateLayout())});c.$watch("showIcons",function(b,c){b!==c&&(a.options.showIcons=b,a.updateLayout())});c.$watch("selectedRow",function(b,c){b!==c&&(c&&(c.selected=!1),a.options.selectedRow=b,a.callAfterSelect(b))});this.sortComparer=this.sortColumn=null;c.$watch("sorting",function(b,c){b!==c&&(a.options.sorting=b)});c.$on(c.name+
"-sort",function(b,c,d,f){a.sort(c,d,f)});this.sort=function(b,c,d){a.sortColumn=b;a.sortComparer=d;if("ascending"==c||"descending"==c||"none"==c)a.options.sorting=c;a.updateCurrentLayout();a.callChange()};this.getCellIndexInCollection=function(b,c,d){var f=-1;if(b)for(var g=0;g<b.length;g++)if(void 0==b[g][a.options.cellFields.cid]){f=c;break}else if(b[g][a.options.cellFields.cid]==d){f=g;break}return f};this.isSortingAllowed=function(){return"ascending"==a.options.sorting||"descending"==a.options.sorting};
this.applySorting=function(b){if(b&&(!a.sortColumn||0!=a.sortColumn[a.options.columnFields.visible])){var c=a.getColumnCurrentIndex(a.sortColumn),d=0<=c?c:a.options.expandColIndex;if(d<a.columnList.length){var g=a.columnList[d][a.options.columnFields.id];a.sortColumn&&a.sortColumn[a.options.columnFields.comparer]?b.sort(a.sortColumn[a.options.columnFields.comparer]):a.sortComparer?b.sort(a.sortComparer):a.isSortingAllowed()&&b.sort(function(b,c){var e=null,l=null;if(b[a.options.rowFields.cells]){var n=
a.getCellIndexInCollection(b[a.options.rowFields.cells],d,g);0<=n&&((e=b[a.options.rowFields.cells][n][a.options.cellFields.value])||(e=b[a.options.rowFields.cells][n][a.options.cellFields.text]),f.isObject(e)&&(e=e.value?e.value:e.text))}c[a.options.rowFields.cells]&&(n=a.getCellIndexInCollection(c[a.options.rowFields.cells],d,g),0<=n&&((l=c[a.options.rowFields.cells][n][a.options.cellFields.value])||(l=c[a.options.rowFields.cells][n][a.options.cellFields.text]),f.isObject(l)&&(l=l.value?l.value:
l.text)));e=void 0!=e?e:null;l=void 0!=l?l:null;switch(a.options.sorting){case "ascending":if(e<l)return-1;if(e>l)return 1;break;case "descending":if(e>l)return-1;if(e<l)return 1;break;default:return 0}})}}};var A=function(b){if(b){var c=f.isFieldAvailable(b.general,"iui-treegrid-column"),d;d=(d=b.header)?{content:f.isFieldAvailable(d.content,"iui-treegrid-column-header-cell-content"),disabled:f.isFieldAvailable(d.disabled,"iui-treegrid-column-header-disabled"),normal:f.isFieldAvailable(d.normal,
"iui-treegrid-column-header"),hovered:f.isFieldAvailable(d.hovered,"iui-treegrid-column-header-hovered"),selected:f.isFieldAvailable(d.selected,"iui-treegrid-column-header-selected")}:a.options.controlStyle.column.header;b=(b=b.footer)?{content:f.isFieldAvailable(b.content,"iui-treegrid-column-footer-cell-content"),disabled:f.isFieldAvailable(b.disabled,"iui-treegrid-column-footer-disabled"),normal:f.isFieldAvailable(b.normal,"iui-treegrid-column-footer"),hovered:f.isFieldAvailable(b.hovered,"iui-treegrid-column-footer-hovered"),
selected:f.isFieldAvailable(b.selected,"iui-treegrid-column-footer-selected")}:a.options.controlStyle.column.footer;return{general:c,header:d,footer:b}}return a.options.controlStyle.column};this.getExpandBoxStyle=function(b){return b?{general:f.isFieldAvailable(b.general,"iui-treegrid-expand-box"),animated:f.isFieldAvailable(b.animated,"iui-treegrid-expand-box-load"),expanded:f.isFieldAvailable(b.expanded,"iui-treegrid-expand-box-open"),collapsed:f.isFieldAvailable(b.collapsed,"iui-treegrid-expand-box-close")}:
a.options.controlStyle.row.expandBox};var hb=function(b){if(b){var c;c=(c=b.general)?{disabled:f.isFieldAvailable(c.disabled,"iui-treegrid-row-disabled"),focused:f.isFieldAvailable(c.focused,"iui-treegrid-row-focused"),normal:f.isFieldAvailable(c.normal,"iui-treegrid-row"),hovered:f.isFieldAvailable(c.hovered,"iui-treegrid-row-hovered"),selected:f.isFieldAvailable(c.selected,"iui-treegrid-row-selected")}:a.options.controlStyle.row.general;var d;var g=b.checkBox;g?(d=f.isFieldAvailable(g.general,"iui-checkbox"),
g=(g=g.box)?{general:f.isFieldAvailable(g.general,"iui-checkbox-box"),disabled:f.isFieldAvailable(g.disabled,"iui-checkbox-disabled"),checked:f.isFieldAvailable(g.checked,"iui-checkbox-checked"),indeterminate:f.isFieldAvailable(g.indeterminate,"iui-checkbox-indeterminate"),unchecked:f.isFieldAvailable(g.unchecked,"iui-checkbox-unchecked")}:a.options.controlStyle.row.checkBox.box,d={general:d,box:g}):d=a.options.controlStyle.row.checkBox;g=a.getExpandBoxStyle(b.expandBox);b=(b=b.cell)?{content:f.isFieldAvailable(b.content,
"iui-treegrid-row-cell-content"),general:f.isFieldAvailable(b.general,"iui-treegrid-row-cell"),disabled:f.isFieldAvailable(b.disabled,"iui-treegrid-row-cell-disabled"),focused:f.isFieldAvailable(b.focused,"iui-treegrid-row-cell-focused"),normal:f.isFieldAvailable(b.normal,"iui-treegrid-row-cell"),hovered:f.isFieldAvailable(b.hovered,"iui-treegrid-row-cell-hovered"),selected:f.isFieldAvailable(b.selected,"iui-treegrid-row-cell-selected")}:a.options.controlStyle.row.cell;return{general:c,checkBox:d,
expandBox:g,cell:b}}return a.options.controlStyle.row},v=function(b){return b?{content:f.isFieldAvailable(b.content,"iui-treegrid-row-cell-content"),general:f.isFieldAvailable(b.general,"iui-treegrid-row-cell"),disabled:f.isFieldAvailable(b.disabled,"iui-treegrid-row-cell-disabled"),focused:f.isFieldAvailable(b.focused,"iui-treegrid-row-cell-focused"),normal:f.isFieldAvailable(b.normal,"iui-treegrid-row-cell"),hovered:f.isFieldAvailable(b.hovered,"iui-treegrid-row-cell-hovered"),selected:f.isFieldAvailable(b.selected,
"iui-treegrid-row-cell-selected")}:a.options.controlStyle.cell};this.updateControlStyle=function(b){a.options.controlStyle=b?{general:f.isFieldAvailable(b.general,"iui-treegrid"),column:A(b.column),row:hb(b.row),cell:v(b.cell)}:{general:f.isFieldAvailable(a.defaultStyle.general,"iui-treegrid"),column:A(a.defaultStyle.column),row:hb(a.defaultStyle.row),cell:v(a.defaultStyle.cell)}};this.getCurrentColumnStyle=function(b,c,d){var f=a.options.controlStyle.column;b&&b.style&&(f=b.style);b=a.options.controlStyle.column.body;
var g=f.body;switch(c){case "header":b=a.options.controlStyle.column.header;g=f.header;break;case "footer":b=a.options.controlStyle.column.footer,g=f.footer}if(d)switch(d){case "content":return g&&g.content?g.content:b.content;case "disabled":return g&&g.disabled?g.disabled:b.disabled;case "hovered":return g&&g.hovered?g.hovered:b.hovered;case "selected":return g&&g.selected?g.selected:b.selected;default:return g&&g.normal?g.normal:b.normal}else return c?g?g:b:f?f:a.options.controlStyle.column};this.getCurrentRowStyle=
function(b,c){var d=a.options.controlStyle.row;if(b)switch(b[a.options.rowFields.style]){case "initial":break;case "parent":return a.getCurrentRowStyle(a.getParent(b),c);default:null!=b.style&&(d=b.style)}if(c){if(f.isString(d.general))return d.general;switch(c){case "disabled":return d.general&&d.general.disabled?d.general.disabled:a.options.controlStyle.row.general.disabled;case "focused":return d.general&&d.general.focused?d.general.focused:a.options.controlStyle.row.general.focused;case "hovered":return d.general&&
d.general.hovered?d.general.hovered:a.options.controlStyle.row.general.hovered;case "selected":return d.general&&d.general.selected?d.general.selected:a.options.controlStyle.row.general.selected;default:return d.general&&d.general.normal?d.general.normal:a.options.controlStyle.row.general.normal}}else return d?d:a.options.controlStyle.row};this.getDefaultCellContentClass=function(){return"iui-treegrid-row-cell-content"};this.getDefaultCellLabelClass=function(){return"iui-treegrid-row-cell-label"};
this.getDefaultCellBorderClass=function(){return"iui-treegrid-lines-both"};this.getCurrentCellStyle=function(b,c,d){var f=a.options.controlStyle.row.cell;if(c)switch(c[a.options.cellFields.style]){case "initial":break;case "parent":b&&(f=v(a.getCurrentRowStyle(b)));break;default:c.style&&(f=c.style)}if(d)switch(d){case "content":return f.content?f.content:a.options.controlStyle.cell.content;case "disabled":return f.disabled?f.disabled:a.options.controlStyle.cell.disabled;case "focused":return f.focused?
f.focused:a.options.controlStyle.cell.focused;case "hovered":return f.hovered?f.hovered:a.options.controlStyle.cell.hovered;case "selected":return f.selected?f.selected:a.options.controlStyle.cell.selected;default:return f.normal?f.normal:a.options.controlStyle.cell.normal}else return f?f:a.options.controlStyle.row.cell}}]).directive("iuiTreegrid",["$compile","$timeout","$interval","IntegralUIInternalService","IntegralUIDragDrop","$window","IntegralUIListCtrlService",function(c,d,l,n,u,f,R){return{restrict:"EA",
controller:"IntegralUITreeGridController",transclude:!0,replace:!0,template:'<div class="iui-treegrid" data-element="treegrid"><div class="iui-treegrid-block"></div></div>',scope:{allowAnimation:"=",allowCellFocus:"=",allowColumnReorder:"=",allowFilter:"=",allowFocus:"=",allowDrag:"=",allowDrop:"=",animationSpeed:"=",autoExpand:"=",columns:"=",controlStyle:"=",editorSettings:"=",expandingColumnIndex:"=",fields:"=",fillSpace:"=",gridLines:"=",hoverSelection:"=",indent:"=",labelEdit:"=",name:"@",options:"=?",
pathSeparator:"@",rowIcon:"=",rows:"=",selectedIndex:"=",selectedRow:"=",selectionMode:"@",showFooter:"=",showHeader:"=",showIcons:"=",sorting:"@",afterCollapse:"&",afterEdit:"&",afterExpand:"&",afterLabelEdit:"&",afterSelect:"&",beforeCollapse:"&",beforeEdit:"&",beforeExpand:"&",beforeLabelEdit:"&",beforeSelect:"&",cellClick:"&",cellHover:"&",cellvalueChanged:"&",cellvalueChanging:"&",change:"&",clearColumns:"&",clearRows:"&",columnAdded:"&",columnAdding:"&",columnClick:"&",columnDblclick:"&",columnHover:"&",
columnPoschanging:"&",columnPoschanged:"&",columnRemoved:"&",columnRemoving:"&",columnRightclick:"&",columnSizechanged:"&",dragDrop:"&",dragEnter:"&",dragLeave:"&",dragOver:"&",events:"=?",gotFocus:"&",keyDown:"&",keyPress:"&",keyUp:"&",loadComplete:"&",lostFocus:"&",rowAdded:"&",rowAdding:"&",rowClick:"&",rowDblclick:"&",rowHover:"&",rowRemoved:"&",rowRemoving:"&",rowRightclick:"&",scrollposChanged:"&",selectionChanged:"&",updateComplete:"&"},link:function(g,p,Nb,a,fc){var C=this,X=p.children().eq(0),
G=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),w=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),ta=angular.element('<div class="iui-scrollbar-corner"></div>'),Ba=null,ua=null,va=null,gb=!1,y=angular.element('<input type="text" class="iui-label-editor" draggable="false" />');a.labelEditStatus=function(a){if(void 0!=a)gb=a;else return gb};var Sa=function(){var b=
"iui-treegrid-block";a.options.showStatusIcons&&(b+=" "+b+"-shift-left");a.options.rtl&&(b+=" "+b+"-rtl");return b};g.$on("$destroy",function(a){C.s2t();ga&&ga.unbind("mousedown");p.unbind("click dblclick dragenter dragleave dragend drop keydown mousedown mouseleave mousemove mousewheel scroll touchstart touchmove touchend");angular.element(f).unbind("dragenter dragover dragend mousemove mousedown mouseup");y&&y.unbind("blur focus keydown mousedown");gc();z&&z.$destroy();x&&x.$destroy()});a.dragIcon=
document.createElement("img");a.dragIcon.width=1;p.append(a.getDropMarkWindow());a.dropMark();var na=function(){Ba&&(d.cancel(Ba),Ba=null)};a.addDropMark=function(){var b;b=p[0];for(var c=null;b;){if(b===document.getElementsByTagName("body")[0]){c=b;break}b=b.offsetParent}if(b=c)angular.element(b).append(a.getDropMarkWindow()),a.dropMark()};a.removeDropMark=function(){a.getDropMarkWindow().remove()};a.isDropInRange=function(b){b=a.getMousePos(b);var c=p[0].getBoundingClientRect();b.x-=angular.element(f)[0].pageXOffset;
b.y-=angular.element(f)[0].pageYOffset;var d=c.top+B,c=c.bottom-K;H&&w&&(c-=w[0].offsetHeight);return b.y<d||b.y>c?!1:!0};var A=angular.element('<div style="opacity:0.75;position:absolute;z-index:999"></div>'),hb=function(){A&&(A.remove(),A.css("top","-9999999px"),A.css("left","-9999999px"))};a.getCellElemFromRow=function(b){return b&&(b=a.getElemFromRow(b))?a.getChildElement(b,"cell"):null};a.openEditor=function(b,c){if(b)switch(b.type){case "cell":c||(c=a.getColumnById(b[a.options.cellFields.cid]));
if(!c){var d=a.getCellColumnIndex(b),m=a.columnsObj.getList();m&&0<=d&&d<m.length&&(c=m[d])}if(c){var d=a.getCellType(b,a.getColumnRealIndex(c)),m=a.getCellRowIndex(b),h=a.getCellColumnIndex(b);if(m=a.getElemFromCell(m,h,c[a.options.columnFields.fixed]))switch(d){case "checkbox":break;case "combobox":break;case "incell":a.openInCellEditor(m,b,c);break;case "dropdown":a.openDropDownEditor(m,b,c);break;default:0!=b[a.options.cellFields.allowEdit]&&ib(null,m,0)}}}};a.closeEditor=function(b,c){if(b)switch(b.type){case "cell":if(c||
(c=a.getColumnById(b[a.options.cellFields.cid])),c)switch(a.getCellType(b,a.getColumnRealIndex(c))){case "incell":a.closeActiveEditor(b);break;case "dropdown":a.closeActiveEditor(b)}else a.closeActiveEditor()}else a.closeActiveEditor();e=null};var v=null,b=!1,e=null,fa=null,k=angular.element('<span class="iui-edit-mark"></span>');a.openInCellEditor=function(q,t,r){b&&a.closeActiveEditor(t,!0);rb();if(t&&r&&(e=t,r='<div ng-include="'+r[a.options.columnFields.editorTemplate]+'"></div>',v=angular.element('<div class="iui-incell-editor"></div>'),
v.append(c(r)(g.$parent)),0!=a.callBeforeEdit(t))){q.children().eq(0).append(v);b=!0;fa="incell";fb();v.bind("mousedown",function(a){a.stopPropagation()});v.bind("mouseup",function(a){a.stopPropagation()});v.bind("click",function(a){a.stopPropagation()});v.bind("keydown",function(b){switch(b.keyCode){case 27:a.closeActiveEditor(e)}b.stopPropagation()});v.bind("keypress",function(a){a.stopPropagation()});v.bind("keyup",function(a){a.stopPropagation()});var m=d(function(){var a=n.getPadding(q[0]),b=
parseInt(getComputedStyle(q[0]).width,10)-(a.left+a.right),a=parseInt(getComputedStyle(q[0]).height,10)+2;v.css("width",b+"px");v.css("height",a+"px");v.css("top",q[0].offsetTop+"px");g.$apply();v.children&&1==v.children().length&&(b=v.children().eq(0),b.children&&1==b.children().length&&b.children().eq(0).css("height",a+"px"));d.cancel(m)},1)}};a.openDropDownEditor=function(q,t,r){b&&a.closeActiveEditor(t,!0);rb();if(t&&r&&(e=t,r='<div ng-include="'+r[a.options.columnFields.editorTemplate]+'"></div>',
v=angular.element('<div class="iui-dropdown-editor"></div>'),v.append(c(r)(g.$parent)),0!=a.callBeforeEdit(t)))var m=d(function(){angular.element(La).append(v);v.bind("mousedown",function(a){a.stopPropagation()});v.bind("mouseup",function(a){a.stopPropagation()});v.bind("click",function(a){a.stopPropagation()});b=!0;fa="dropdown";var a=q[0].getBoundingClientRect(),c=angular.element(f)[0].pageXOffset,r=angular.element(f)[0].pageYOffset,t=d(function(){var b=n.getPadding(q[0]),b=parseInt(getComputedStyle(q[0]).width,
10)+(b.left+b.right),m=n.getPadding(v[0]),b=b-(m.left+m.right),m=parseInt(getComputedStyle(v[0]).width,10);b<m&&(b=m);m=a.right-(b+3)+c;v.css("top",a.bottom+r+"px");v.css("left",m+"px");v.css("width",b+"px");g.$apply();d.cancel(t)},1);d.cancel(m)},1)};a.closeActiveEditor=function(c,d){b=!1;rb();v&&v.remove();fa=e=null;d||a.callAfterEdit(c)};var rb=function(){v&&v.unbind("click keydown keypress keyup mousedown mouseup")},sb=function(a,b){a&&(k.addClass("iui-edit-mark iui-edit-mark-"+b),a.append(k),
k.css("left",a[0].offsetLeft+a[0].offsetWidth-k[0].offsetWidth-2+"px"),k.css("top",a[0].offsetTop+(a[0].offsetHeight-k[0].offsetHeight)/2+"px"))},fb=function(){k&&("dropdown"!=fa||"dropdown"==fa&&!b)&&(k.removeAttr("class"),k.remove())},Ob=null,Aa=angular.element('<div class="iui-dropdown-mark"><span></span></div>'),Pb=function(a,b){!a||Ta&&!b||(a.append(Aa),Aa.css("top",a[0].offsetTop+"px"),Aa.css("left",a[0].offsetLeft+a[0].offsetWidth-Aa[0].offsetWidth+"px"),Aa.css("height",getComputedStyle(a[0]).height))},
Ca=function(a){!Aa||Ta&&!a||Aa.remove()};a.getCellType=function(b,c){var d=null,m="label";b&&(d=a.getColumnById(b[a.options.cellFields.cid]));!d&&0<=c&&c<a.columnList.length&&(d=a.columnList[c]);d&&(m=d[a.options.columnFields.editorType]);return m};var La=n.getBodyElem(p[0]),jb=n.getUniqueId(4),Y=null,Ta=!1,kb=0,Ic=function(b,t,r){if(La&&b.items&&0<b.items.length){b=n.getUniqueId(4);var m=c('<iui-list name="'+b+'" style="position:absolute;top:-99px;height:100px" items="data['+t+"].column."+a.options.columnFields.editorSettings+
'.items"></iui-list>')(z);angular.element(La).append(m);R.updateLayout(b);var h=d(function(){if(0<m.children().length){var a=m.children().eq(0);0<a.children().length&&(kb=angular.element(a.children().eq(0))[0].offsetHeight,r&&(r.avgItemHeight=kb))}m.remove();d.cancel(h)},1)}},Ma=null,tb=function(b,t,r,m){var h=a.getCell(r,m);if(h!=Ob&&(Ob=h,Y&&Y.remove(),Ma&&Ma.$destroy(),La)){Ma=g.$new();Ma.data=a.columnList[m];e=h;var ca='<iui-list name="'+jb+'" style="position:absolute;"',ca=ca+(' items="data.'+
a.options.columnFields.editorSettings+'.items"'),ca=ca+(' item-icon="data.'+a.options.columnFields.editorSettings+'.itemIcon"'),ca=ca+(' show-icons="data.'+a.options.columnFields.editorSettings+'.showIcons"'),ca=ca+(' checkbox-settings="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings"'),ca=ca+(' show-check-boxes="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings.showCheckBoxes"');Y=c(ca+(' nav-selection="false" before-select="onCellValueChanging(e, '+r+", "+m+')" after-select="onCellValueChanged(e, '+
r+", "+m+')"></iui-list>'))(Ma);kb=0;Ua&&m<Ua.length&&(kb=Ua[m].avgItemHeight);var Hc=d(function(){angular.element(La).append(Y);var c=b[0].getBoundingClientRect(),m=angular.element(f)[0].pageXOffset,r=angular.element(f)[0].pageYOffset,r=c.bottom+r-1,c=c.left+m,m=b.children().eq(0),e=n.getPadding(m[0]),m=parseInt(getComputedStyle(m[0]).width,10)+(e.left+e.right),e=n.getPadding(Y[0]),m=m-(e.left+e.right);void 0!=t.dropDownWidth&&m<t.dropDownWidth&&(m=t.dropDownWidth);e=void 0!=t.dropDownHeight?t.dropDownHeight:
100;void 0!=t.maxDropDownItems&&(e=kb*t.maxDropDownItems);Y.css("top",r+"px");Y.css("left",c+"px");Y.css("width",m+"px");Y.css("height",e+"px");Y.css("z-index","999");h&&h[a.options.cellFields.value]&&R.selectedItem(jb,h[a.options.cellFields.value]);R.updateLayout(jb);var ca=d(function(){if(h&&h[a.options.cellFields.value]){R.ensureVisible(jb,h[a.options.cellFields.value]);var b=d(function(){R.focus(jb,h[a.options.cellFields.value]);d.cancel(b)},1)}d.cancel(ca)},10);Aa&&(Ca(!0),Pb(b,!0));Ta=!0;Jc();
d.cancel(Hc)},1)}};a.removeDropDownList=function(a){Y&&(Ob=null,Y.remove(),Ta=!1,a||Ca(),Y.unbind("keydown"));Ma&&Ma.$destroy();e=null};var Jc=function(){Y.bind("keydown",function(b){switch(b.keyCode){case 27:a.removeDropDownList(),Ca()}})},ib=function(b,c,r){a.options.labelEdit&&(void 0===r&&(r=500),ua=d(function(){if(ua)var a=d(function(){ub(b,c,!0);d.cancel(a)},r);d.cancel(ua)},r/3))},vb=function(){ua&&(d.cancel(ua),ua=null)},Va=null,Wa=null,ub=function(b,c,r){if(a.dragDropStatus())g=y[0].value,
a.labelEditStatus(!1),y.unbind("blur focus keydown mousedown"),y.remove(),Wa=Va=null;else{var m=a.getRowFromChildElem(c);if(m){var h=a.getRowCurrentIndex(m),e=a.getIndexFromElem(c),f=a.getCellObject(h,e),g="",g=c.children().eq(0);if(f)if(r){if(0!=a.callBeforeLabelEdit(f)){Va=m;Wa=f;a.labelEditStatus(!0);y.unbind("blur focus keydown mousedown");b=parseInt(getComputedStyle(c[0]).width,10)-4;r=parseInt(getComputedStyle(c[0]).height,10)-3;y.css("top",c[0].offsetTop+"px");y.css("left",c[0].offsetLeft+
"px");y.css("width",b+"px");y.css("height",r+"px");g.append(y);y[0].value=f[a.options.cellFields.text];y.bind("keydown",function(b){switch(b.keyCode){case 13:f[a.options.cellFields.text]=y[0].value?y[0].value:"null";ub(b,c,!1);break;case 27:ub(b,c,!1)}b.stopPropagation()});y.bind("focus",function(b){var c=angular.element(this);a.callGotFocus(b,Va,Wa,!0,c[0].value)});y.bind("blur",function(a){ub(a)});y.bind("mousedown",function(a){a.stopPropagation()});var l=d(function(){y[0].focus();y[0].select();
d.cancel(l)},10)}}else g=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown"),y.remove(),a.updateView(),a.updateFocus(h,e),a.callAfterLabelEdit(f),a.callLostFocus(b,m,f,!0,g),Wa=Va=null}else g=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown mousedown"),y.remove(),a.callAfterLabelEdit(),a.updateView(),a.callLostFocus(b,Va,Wa,!0,g),Wa=Va=null}};p.bind("mousemove",function(b){if(0===b.button&&ia&&I){a.getColumnCurrentIndex(I);var c=a.getMousePos(b),d=c.y+16,c=c.x+20;oa.empty();
oa.append("<span>"+I[a.options.columnFields.headerText]+"</span>");oa.css("top",d+"px");oa.css("left",c+"px");oa.css("display","block");hc();b.stopPropagation()}});var kc=function(){for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var d=0;d<c.length;d++){var m=angular.element(c[d]);ic(m);for(var m=m.find("td"),h=0;h<m.length;h++){var e=angular.element(m[h]),f=a.getElement(e,"expandbox");f&&f.unbind("click touchend");jc(e)}}b++;c=1==b?"left":"right"}},gc=function(){rb();for(var b=
0,c="none";3>b;){var d=a.getRowElems(c);if(d&&0<d.length)for(var m=0;m<d.length;m++){var h=angular.element(d[m]);ic(h);for(var h=h.find("td"),e=0;e<h.length;e++){var f=angular.element(h[e]),g=a.getElement(f,"expandbox");g&&g.unbind("click touchend");jc(f)}}if((d=a.getHeaderElem(c))&&0<d.length)for(m=0;m<d.length;m++)for(h=angular.element(d[m]),h=h.find("td"),e=0;e<h.length;e++)(f=angular.element(h[e]))&&(c=a.getChildElement(f,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&c.unbind("mousedown");
b++;c=1==b?"left":"right"}},Nc=function(){kc();for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var d=null,m=c.length-1,h=0;h<=m;h++){d=angular.element(c[h]);Kc(d);for(var e=d.find("td"),f=0;f<e.length;f++){var g=angular.element(e[f]);Lc(a.getElement(g,"expandbox"));Mc(g,a.getRowFromElem(d),f)}}b++;c=1==b?"left":"right"}},ia=!1,I=null,Xa=-1,wb=function(b,c){if(b){var d=a.getColumnCurrentIndex(b),m=a.getColumnWidth(b);return a.isColumnWithFixedWidth(d)||10<c.x&&c.x<m-10}return!1},
Sb=function(b){b=b.find("td");for(var c=0;c<b.length;c++)currentElem=angular.element(b[c]),currentElem.bind("click",function(b){if(1===b.which){var c=n.getClientMousePos(b,this),h=a.getColumnFromElem(this);h&&wb(h,c)&&a.callColumnClick(h,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("dblclick",function(b){b.preventDefault();if(1===b.which){var c=n.getClientMousePos(b,this),h=a.getColumnFromElem(this);h&&wb(h,c)&&a.callColumnDblClick(h,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("mouseenter",
function(b){if(!L&&!ja){var c=a.getColumnFromElem(this);c&&(a.hoverColumn=c,a.refresh(c),a.callColumnHover(c));if(1===b.which&&ia&&I&&a.hoverColumn&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&Z&&(Z.remove(),a.hoverColumn!=I)){var h=angular.element(this);h.append(Z);b=parseInt(getComputedStyle(h[0]).height,10);c=parseInt(getComputedStyle(Z[0]).height,10);h=n.getPadding(h[0]);Z.css("top",(b+h.top+h.bottom-c)/2+"px")}}}),currentElem.bind("mouseleave",function(b){L||ja||(a.hoverColumn=null,(b=
a.getColumnFromElem(this))&&a.refresh(b),Z&&Z.remove(),L||p.css("cursor","default"))}),currentElem.bind("mousemove",function(b){var c=angular.element(this);if(1===b.which&&ia&&I&&a.hoverColumn&&a.hoverColumn!=I&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&I[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed])c=parseInt(getComputedStyle(c[0]).width,10),Z.empty(),Xa=-1,b.offsetX>c/2?(Xa=2,Z.append('<span class="iui-treegrid-column-reorder-mark-right"></span>'),Z.css("left",
"auto"),Z.css("right","0")):(Xa=1,Z.append('<span class="iui-treegrid-column-reorder-mark-left"></span>'),Z.css("left","0"),Z.css("right","auto"));else{b=n.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10),h=a.getColumnWidth(a.columnList[c]),d=10;a.isFilteringAllowed(a.columnList[c])&&(d=0);10>b.x&&!a.isColumnWithFixedWidth(c-1)&&lc(c,"left")?(p.css("cursor","ew-resize"),wa="left"):b.x>h-d&&!a.isColumnWithFixedWidth(c)&&lc(c,"right")?(p.css("cursor","ew-resize"),wa="right"):L||
(p.css("cursor","default"),wa="none")}}),currentElem.bind("mouseup",function(b){if(1===b.which&&ia&&I&&a.hoverColumn&&a.hoverColumn!=I&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&I[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed]&&0!=a.callColumnPosChanging(I,a.hoverColumn)){b=a.columnList[0];0<=a.options.expandColIndex&&a.options.expandColIndex<a.columnList.length&&(b=a.columnList[a.options.expandColIndex]);var c=a.getColumnCurrentIndex(I),h=a.getColumnCurrentIndex(a.hoverColumn);
c!=h&&(c<h?1==Xa&&h--:c>h&&2==Xa&&h++,a.columnsObj.moveObject(c,h),a.updateColumnList(),b=a.getColumnCurrentIndex(b),b!=a.options.expandColIndex?(a.options.expandColIndex=b,a.updateLayout()):a.updateView(),a.callColumnPosChanged(I,a.hoverColumn))}I=null;Xa=-1;L=ia=!1;p.css("cursor","default")}),currentElem.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();n.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10);if(0===b.button&&!L){var h=c,d=
"none";0<=c&&c<a.columnList.length&&(d=a.columnList[c][a.options.columnFields.fixed]);switch(wa){case "left":"right"==d?h=c:(c=Qb(h-1,d))?(h=a.getColumnCurrentIndex(c),0<=h&&h<a.columnList.length&&(a.columnList[h][a.options.columnFields.fixed]!=d?(h=-1,L=!1):L=!0)):L=!1;0<=h&&(L=!0);break;case "right":"right"==d?(c=Rb(h+1,d))?(h=a.getColumnCurrentIndex(c),0<=h&&h<a.columnList.length&&(a.columnList[h][a.options.columnFields.fixed]!=d?(h=-1,L=!1):L=!0)):L=!1:(h=c,L=!0)}!a.isColumnWithFixedWidth(h)&&
L?a.setColumnResizingParams(h,wa,a.getMousePos(b).x):L=!1}if(!L&&(h=a.getColumnFromChildElem(this)))switch(d=n.getClientMousePos(b,this),wb(h,d)&&a.columnSelection(h),b.which){case 1:a.options.allowColumnReorder&&0!=h[a.options.columnFields.allowDrag]&&0==ia&&(I=h,a.getMousePos(b),ia=!0,(h=n.getBodyElem(p[0]))&&angular.element(h).append(oa));break;case 3:wb(h,d)&&a.callColumnRightClick(h,a.getMousePos(b))}b.stopPropagation()}),function(b){b&&(b=a.getChildElement(b,"column-header-cell"))&&(b=a.getContentElement(b,
"filter-button"))&&b.bind("mousedown",function(a){1==a.which&&Oc(this);a.stopPropagation()})}(currentElem)},ga=null,Oc=function(b){a.closeFilterWindow();var e=a.getColumnFromChildElem(b);if(e){var r=angular.element(b),m=r.parent().parent();if(La){b='<div ng-include="'+e[a.options.columnFields.filterTemplate]+'"></div>';ga=angular.element('<div class="iui-filter-window"></div>');ga.append(c(b)(g.$parent));var h=d(function(){angular.element(La).append(ga);ga.bind("mousedown",function(a){a.stopPropagation()});
r[0].getBoundingClientRect();var a=m[0].getBoundingClientRect(),b=angular.element(f)[0].pageXOffset,c=angular.element(f)[0].pageYOffset,q=d(function(){var h=a.bottom+c,m=a.right-(parseInt(getComputedStyle(ga[0]).width,10)+3)+b;ga.css("top",h+"px");ga.css("left",m+"px");d.cancel(q)},1);d.cancel(h)},1)}}};a.closeFilterWindow=function(){ga&&(ga.unbind("mousedown"),ga.remove())};var ic=function(a){a&&a.unbind("blur dragover dragend focus keydown keyup keypress mousedown mouseenter mouseleave")},Kc=function(b){b&&
(b.bind("dragover",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){if(a.isScrollBarVisible("vertical")){var c=a.getMousePos(b),m=p[0].getBoundingClientRect();c.x-=angular.element(f)[0].pageXOffset;c.y-=angular.element(f)[0].pageYOffset;var h=m.top+B+25,m=m.bottom-K-25;H&&w&&(m-=w[0].offsetHeight);c.y<h?xb(!1):c.y>m?xb(!0):Ya()}else Ya();b.stopPropagation()}}),b.bind("dragend",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),a.dragDropStatus(!1),
a.dropMark(),u.getData().source||u.clearData())}),b.bind("mouseenter",function(b){if(!ja){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&!ia&&(a.hoverRow=c,a.refresh(c),a.callRowHover(b,c),a.options.hoverSelection&&(va=d(function(){va&&a.rowSelection(c,b.shiftKey,b.ctrlKey)},500)))}}),b.bind("mouseleave",function(b){ja||(a.hoverRow=null,(b=a.getRowFromElem(this))&&a.isRowEnabled(b)&&a.refresh(b),va&&(d.cancel(va),va=null))}),b.bind("keydown",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){var m=
!0;a.callKeyDown(b,c);var h=a.getRowCurrentIndex(c);switch(b.keyCode){case 9:mc(b,c,h);break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;case 27:m=!1;break;case 33:nc(b,h);break;case 34:oc(b,h);break;case 35:pc(b,h);break;case 36:qc(b,h);break;case 37:rc(b,c,h);break;case 32:b.preventDefault();Tb(void 0,void 0);a.rowSelection(c,b.shiftKey,b.ctrlKey,c.selected);g.$apply();break;case 38:Ub(b,h);break;case 39:sc(b,c,h);break;case 40:Vb(b,h);break;default:(b.ctrlKey||
b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}m&&b.stopPropagation()}}),b.bind("keyup",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,c)}}),b.bind("keypress",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&a.callKeyPress(b,c)}),b.bind("mousedown",
function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor()}),b.bind("focus",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)?a.callGotFocus(b,c):a.updateFocus()}),b.bind("blur",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&a.callLostFocus(b,c)}))},Lc=function(b){b&&(b.bind("click",function(b){var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}),b.bind("touchend",
function(b){b.preventDefault();var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}))},yb={x:0,y:0},Za={x:0,y:0},$a=!1,Wb=!1,xa=null,tc=function(){return{x:angular.element(f)[0].pageXOffset,y:angular.element(f)[0].pageYOffset}},ab=function(a){var b=tc();return{x:a.x-b.x,y:a.y-b.y}},Mc=function(c,t,r){c&&(c.bind("dragstart",function(b){if(a.labelEditStatus())b.preventDefault();else{u.clearData();var c=
a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c))if(vb(),a.isDragAllowed(c)){a.dragDropStatus(!0);a.addDropMark();b.dataTransfer?(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():"")):b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():""));b={source:c,sourceCtrl:a,
sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":b.source=a.options.selectedRows;break;case "multi-extended":b.source=a.options.selectedRows}u.setData(b)}else b.dataTransfer?b.dataTransfer.effectAllowed="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="none")}}),c.bind("dragover",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var d=angular.element(this);b.preventDefault();var q=!0;b.dataTransfer?
q="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(q="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(q&&(c=a.getRowFromChildElem(d))){var q=d[0].getBoundingClientRect(),e=angular.element(f)[0].pageXOffset,t=angular.element(f)[0].pageYOffset,r=a.getMousePos(b);r.x-=q.left+e;r.y-=q.top+t;d=u.getDropPos(r,{x:0,y:0,width:d[0].offsetWidth,height:d[0].offsetHeight});e=u.getData();q=a.isDropAllowed(e.source,c,d);t={event:b,sourceTree:e.sourceCtrl?
e.sourceCtrl.getTreeName():"",dragRow:e.source,targetTree:a.getTreeName(),targetRow:c,isDropAllowed:q,dropPos:d,mousePos:a.getMousePos(b)};t=a.callDragOver(t);if(q&&!1!==t){t=a.getMousePos(b);b=t.y+16;t=t.x+20;r=a.getDropMarkWindow();r.empty();var g="iui-drop-marker-move-in";switch(d){case 1:g="iui-drop-marker-move-up";break;case 2:g="iui-drop-marker-move-down"}r.append("<span class='"+g+"'></span><span class='iui-drop-marker-title'>"+c[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),
{top:b,left:t});a.dropMark(q);u.setData({source:e.source,sourceList:e.sourceList,target:c,dropPos:d})}else b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark()}}}),c.bind("drop",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var d=angular.element(this);b.preventDefault();na();a.dropMark();c=!0;b.dataTransfer?c="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&
b.originalEvent.dataTransfer&&(c="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(c){var q=a.getRowFromChildElem(d);if(q){var d=u.getData(),e=d.source;e||(e=a.getDnDSource(b));if(c=a.isDropAllowed(e,q,d.dropPos))a.toggle(q,!0),e&&(c={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getTreeName():"",dragRow:e,targetTree:a.getTreeName(),targetRow:q,isDropAllowed:c,dropPos:d.dropPos,mousePos:a.getMousePos(b)},!1!==a.callDragDrop(c)&&(a.drop(d),g.$$phase||g.$apply()))}}u.clearData();b.stopPropagation()}}),
c.bind("dragenter",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){b.preventDefault();if(a.options.autoExpand)var q=d(function(){Ba||(Ba=d(function(){Ba&&a.toggle(c,!0)},750));d.cancel(q)},1);var e=u.getData();e.source||(e.source=a.getDnDSource(b));e={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getTreeName():"",dragRow:e.source,targetTree:a.getTreeName(),targetRow:e.target,mousePos:a.getMousePos(b)};a.callDragEnter(e);b.stopPropagation()}}),c.bind("dragleave",function(b){a.hoverRow=
null;var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),na(),c=u.getData(),c.source||(c.source=a.getDnDSource(b)),c={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getTreeName():"",dragRow:c.source,targetTree:a.getTreeName(),targetRow:c.target,mousePos:a.getMousePos(b)},a.callDragLeave(c),b.stopPropagation())}),c.bind("touchstart",function(c){c.preventDefault();var h=a.getTouchData(c);if(h&&0<h.length){Wb=!0;var q=d(function(){Wb=!1;d.cancel(q)},750);yb=ab({x:h[0].pageX,y:h[0].pageY});
a.closeFilterWindow();h=yb;if((h=a.getRowAt(h.x,h.y))&&a.isRowEnabled(h)){var t=angular.element(this);a.mouseButtonStatus(!0);xa=h;var r=a.getRowCurrentIndex(h),f=parseInt(a.getIndexFromElem(this),10),g=a.getCell(r,f),l=a.getCellType(g,f),k=null,n=a.options.editorSettings;t[0].focus();a.updateFocus(r,f);g&&(k=a.getColumnById(g[a.options.cellFields.cid]));!k&&0<=f&&f<a.columnList.length&&(k=a.columnList[f]);var p="click"==a.options.editorSettings.activate;k&&k[a.options.columnFields.editorSettings]&&
(n=k[a.options.columnFields.editorSettings],p=void 0!=n.activate?"click"==n.activate:p);g&&g!=e?a.closeEditor(e):a.closeEditor();switch(l){case "checkbox":break;case "combobox":a.rowSelection(h,c.shiftKey,c.ctrlKey);g&&0!=g[a.options.cellFields.allowEdit]&&k&&p?tb(angular.element(this),n,r,f):a.removeDropDownList();break;case "incell":a.rowSelection(h,c.shiftKey,c.ctrlKey);!b&&g&&0!=g[a.options.cellFields.allowEdit]&&p&&a.openInCellEditor(t,g,k);break;case "dropdown":a.rowSelection(h,c.shiftKey,c.ctrlKey);
!b&&g&&0!=g[a.options.cellFields.allowEdit]&&p&&a.openDropDownEditor(t,g,k);break;default:a.rowSelection(h,c.shiftKey,c.ctrlKey),a.removeDropDownList(),g&&0!=g[a.options.cellFields.allowEdit]&&p&&ib(c,angular.element(this))}}}}),c.bind("touchmove",function(b){var c,d,q=a.getTouchData(b);if(q&&0<q.length){Za=ab({x:q[0].pageX,y:q[0].pageY});var q=Math.abs(Za.x-yb.x),e=Math.abs(Za.y-yb.y),t=p[0].getBoundingClientRect();if(u.hitTest(Za.x,Za.y,t)){if(b.preventDefault(),A&&A.css("display","block"),!Wb)if(!$a&&
(2<q||2<e)&&xa&&a.isRowEnabled(xa))if(angular.element(this),a.labelEditStatus())b.preventDefault();else{$a=!0;u.clearData();if((q=a.getTouchData(b))&&0<q.length&&(ab({x:q[0].pageX,y:q[0].pageY}),xa&&a.isRowEnabled(xa)&&(vb(),a.isDragAllowed(xa)))){a.dragDropStatus(!0);a.addDropMark();q={source:xa,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":q.source=a.options.selectedRows;break;case "multi-extended":q.source=a.options.selectedRows}u.setData(q);if(q=
a.getCellElemFromRow(xa))if(q=a.getContentElement(q))A.empty(),A.append(q.clone()),A.css("display","none"),p.append(A)}b.stopPropagation()}else if($a&&(angular.element(this),b.preventDefault(),(e=a.getTouchData(b))&&0<e.length)){var q=tc(),r=ab({x:e[0].pageX,y:e[0].pageY});if(e=a.getRowAt(r.x,r.y)){var f=a.getCellElemFromRow(e);if(f){var t=f[0].getBoundingClientRect(),f=u.getDropPos({x:r.x-t.left,y:r.y-t.top},{x:0,y:0,width:f[0].offsetWidth,height:f[0].offsetHeight}),t=u.getData(),l=a.isDropAllowed(t.source,
e,f);b={event:b,sourceTree:t.sourceCtrl?t.sourceCtrl.getTreeName():"",dragRow:t.source,targetTree:a.getTreeName(),targetRow:e,isDropAllowed:l,dropPos:f,mousePos:r};d=p[0].getBoundingClientRect();c=r.x-d.left;d=r.y-d.top;A.css("top",d-16+"px");A.css("left",c+"px");A.css("display","block");b=a.callDragOver(b);if(l&&0!=b){b=r.y+q.y+16;q=r.x+q.x+20;r=a.getDropMarkWindow();r.empty();c="iui-drop-marker-move-in";switch(f){case 1:c="iui-drop-marker-move-up";break;case 2:c="iui-drop-marker-move-down"}r.append("<span class='"+
c+"'></span><span class='iui-drop-marker-title'>"+e[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:q});a.dropMark(l);u.setData({source:t.source,sourceList:t.sourceList,target:e,dropPos:f})}else a.dropMark(),A&&A.css("display","none")}}else t=p[0].getBoundingClientRect(),e=t.top+B,t=t.bottom-K,H&&w&&(t-=w[0].offsetHeight),!a.options.allowDrop||r.y<e||r.y>t?(a.dropMark(),A&&A.css("display","none")):(d=p[0].getBoundingClientRect(),c=r.x-d.left,d=r.y-d.top,
A.css("top",d-16+"px"),A.css("left",c+"px"),A.css("display","block"),e=u.getData(),t={source:e.source,sourceCtrl:e.sourceCtrl,target:null,dropPos:-1},u.setData(t),b={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getTreeName():"",dragRow:e.source,targetTree:a.getTreeName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:r},b=a.callDragOver(b),0==b?a.dropMark():(b=r.y+q.y+16,q=r.x+q.x+20,r=a.getDropMarkWindow(),r.empty(),r.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+
(g.name?g.name:"TreeGrid")+"</span>"),a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:q}),a.dropMark(!0)))}}else b.preventDefault(),a.dropMark(),a.cancelScrollTimer(),A&&A.css("display","none")}}),c.bind("touchend",function(b){var c=!1;if((c=a.getTouchData(b))&&0<c.length){var c=ab({x:c[0].pageX,y:c[0].pageY}),d=p[0].getBoundingClientRect();if(u.hitTest(c.x,c.y,d))if($a){angular.element(this);b.preventDefault();na();a.dropMark();hb();if((c=a.getTouchData(b))&&0<c.length){var c=ab({x:c[0].pageX,
y:c[0].pageY}),q=a.getRowAt(c.x,c.y);if(q){var d=u.getData(),e=d.source,t=a.isDropAllowed(e,q,d.dropPos);t&&(a.toggle(q,!0),e&&(c={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getTreeName():"",dragRow:e,targetTree:a.getTreeName(),targetRow:q,isDropAllowed:t,dropPos:d.dropPos,mousePos:c},c=a.callDragDrop(c),!1!==c&&(a.drop(d),g.$$phase||g.$apply())))}else a.dropMark(),q=p[0].getBoundingClientRect(),d=q.top+B,q=q.bottom-K,H&&w&&(q-=w[0].offsetHeight),c.y>=d&&c.y<=q&&(d=u.getData(),d.source&&(c={event:b,
sourceTree:d.sourceCtrl?d.sourceCtrl.getTreeName():"",dragRow:d.source,targetTree:a.getTreeName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:c},c=a.callDragDrop(c),!1!==c&&(a.drop(d),g.$$phase||g.$apply())))}u.clearData();a.dragDropStatus(!1);b.stopPropagation()}else a.mouseButtonStatus(!1),(c=a.getRowFromChildElem(this))&&a.isRowEnabled(c)&&a.updateSelection(c,b.shiftKey),vb()}c=$a;a.removeDropMark();hb();Za={x:0,y:0};$a=!1;xa=null;c&&b.stopPropagation()}),c.bind("dblclick",
function(c){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var q=angular.element(this);c.preventDefault();if(1===c.which){var e=a.getRowCurrentIndex(d),t=parseInt(a.getIndexFromElem(this),10),r=a.getCell(e,t),f=a.getCellType(r,t),g=null,l=a.options.editorSettings;r&&(g=a.getColumnById(r[a.options.cellFields.cid]));!g&&0<=t&&t<a.columnList.length&&(g=a.columnList[t]);var k="dblclick"==a.options.editorSettings.activate;g&&g[a.options.columnFields.editorSettings]&&(l=g[a.options.columnFields.editorSettings],
k=void 0!=l.activate?"dblclick"==l.activate:k);switch(f){case "checkbox":break;case "combobox":r&&0!=r[a.options.cellFields.allowEdit]&&g&&k?tb(angular.element(this),l,e,t):a.removeDropDownList();break;case "incell":!b&&r&&0!=r[a.options.cellFields.allowEdit]&&k&&a.openInCellEditor(q,r,g);break;case "dropdown":!b&&r&&0!=r[a.options.cellFields.allowEdit]&&k&&a.openDropDownEditor(q,r,g);break;default:a.removeDropDownList(),r&&0!=r[a.options.cellFields.allowEdit]&&k&&ib(c,angular.element(this),0)}0!=
a.callRowDblClick(d,a.getMousePos(c))&&"checkbox"!=f&&"checkbox"!=f&&r&&!k&&(a.toggle(d),a.updateFocus(e,t))}c.stopPropagation()}}),c.bind("mouseenter",function(c){if(!ja){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)&&!ia){var q=a.getRowCurrentIndex(d),r=parseInt(a.getIndexFromElem(this),10);if(q=a.getCell(q,r))if(a.hoverCell=q,a.refresh(d),a.callCellHover(c,q),c=angular.element(this),q&&0!=q[a.options.cellFields.allowEdit])switch(r=a.getCellType(q,r),r){case "combobox":Ta||Pb(c);break;
case "incell":b&&q==e||sb(c,r);break;case "dropdown":b&&q!=e||sb(c,r);break;default:Ca(),fb()}else Ca()}}}),c.bind("mouseleave",function(b){if(!ja&&(a.hoverCell=null,(b=a.getRowFromChildElem(this))&&a.isRowEnabled(b))){b=a.getRowCurrentIndex(b);var c=parseInt(a.getIndexFromElem(this),10);a.getCell(b,c)&&(Ca(),fb())}}),c.bind("keydown",function(c){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var q=!0,e=angular.element(this);a.callKeyDown(c,d);var r=a.getRowCurrentIndex(d),t=parseInt(a.getIndexFromElem(this),
10),f=a.getCell(r,t),l=a.getCellType(f,t),k=a.getColumnById(f[a.options.cellFields.cid]);!k&&0<=t&&t<a.columnList.length&&(k=a.columnList[t]);switch(c.keyCode){case 9:mc(c,d,r,t);break;case 13:switch(l){case "checkbox":Tb(f,t);break;case "combobox":f&&0!=f[a.options.cellFields.allowEdit]?k&&tb(angular.element(this),k[a.options.columnFields.editorSettings],r,t):a.removeDropDownList();break;case "incell":!b&&f&&0!=f[a.options.cellFields.allowEdit]&&a.openInCellEditor(e,f,k);break;case "dropdown":!b&&
f&&0!=f[a.options.cellFields.allowEdit]&&a.openDropDownEditor(e,f,k);break;default:f&&0!=f[a.options.cellFields.allowEdit]&&ib(c,angular.element(this),0)}break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;case 27:q=!1;break;case 33:nc(c,r,t);break;case 34:oc(c,r,t);break;case 35:pc(c,r,t);break;case 36:qc(c,r,t);break;case 37:rc(c,d,r,t);break;case 32:c.preventDefault();Tb(f,t);a.rowSelection(d,c.shiftKey,c.ctrlKey,d.selected);g.$apply();break;case 38:Ub(c,
r,t);break;case 39:sc(c,d,r,t);break;case 40:Vb(c,r,t);break;default:(c.ctrlKey||c.metaKey)&&a.updateSelectionStatus("ctrl"),c.shiftKey&&a.updateSelectionStatus("shift")}q&&c.stopPropagation()}}),c.bind("keyup",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,c);b.stopPropagation()}}),c.bind("keypress",
function(b){var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.callKeyPress(b,c),b.stopPropagation())}),c.bind("click",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){if(1===b.which){var d=a.getRowCurrentIndex(c),q=parseInt(a.getIndexFromElem(this),10),d=a.getCell(d,q);a.callCellClick(b,c,d,a.getMousePos(b));a.callRowClick(b,c,a.getMousePos(b))}b.stopPropagation()}}),c.bind("mousedown",function(c){a.closeFilterWindow();var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var q=
angular.element(this);a.mouseButtonStatus(!0);switch(c.which){case 1:var r=a.getRowCurrentIndex(d),t=parseInt(a.getIndexFromElem(this),10),f=a.getCell(r,t),g=a.getCellType(f,t),k=null,l=a.options.editorSettings;f&&(k=a.getColumnById(f[a.options.cellFields.cid]));!k&&0<=t&&t<a.columnList.length&&(k=a.columnList[t]);var n="click"==a.options.editorSettings.activate;k&&k[a.options.columnFields.editorSettings]&&(l=k[a.options.columnFields.editorSettings],n=void 0!=l.activate?"click"==l.activate:n);f&&
f!=e?a.closeEditor(e):a.closeEditor();switch(g){case "checkbox":break;case "combobox":a.rowSelection(d,c.shiftKey,c.ctrlKey);f&&0!=f[a.options.cellFields.allowEdit]&&k&&n?tb(angular.element(this),l,r,t):a.removeDropDownList();break;case "incell":a.rowSelection(d,c.shiftKey,c.ctrlKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&n&&a.openInCellEditor(q,f,k);break;case "dropdown":a.rowSelection(d,c.shiftKey,c.ctrlKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&n&&a.openDropDownEditor(q,f,k);break;
default:a.rowSelection(d,c.shiftKey,c.ctrlKey),a.removeDropDownList(),f&&0!=f[a.options.cellFields.allowEdit]&&n&&ib(c,angular.element(this))}break;case 3:a.rowSelection(d,c.shiftKey,c.ctrlKey),a.callRowRightClick(d,a.getMousePos(c))}c.stopPropagation()}}),c.bind("mouseup",function(b){a.mouseButtonStatus(!1);var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&a.updateSelection(c,b.shiftKey);1===b.which&&vb()}),c.bind("focus",function(c){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var q=
a.getRowCurrentIndex(d),e=parseInt(a.getIndexFromElem(this),10),q=a.getCell(q,e);a.callGotFocus(c,d,q);if(q&&0!=q[a.options.cellFields.allowEdit])switch(c=angular.element(this),e=a.getCellType(q,e),e){case "combobox":Ta||Pb(c);break;case "incell":b||sb(c,e);break;case "dropdown":b||sb(c,e);break;default:Ca()}else Ca()}}),c.bind("blur",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var d=a.getRowCurrentIndex(c),q=parseInt(a.getIndexFromElem(this),10),d=a.getCell(d,q);a.callLostFocus(b,
c,d)}}))},jc=function(a){a&&a.unbind("blur click dragstart dragover drop dragenter dragleave dblclick focus keydown keypress keyup mouseenter mouseleave mousemove mousedown mouseup touchstart touchmove touchend")};a.getTopRow=function(){return a.isRowIndexInRange(D-1)?a.currentList[D]:0<a.currentList.length?a.currentList[0]:null};a.getFooterElem=function(a){switch(a){case "left":return ha;case "right":return T}return pa};a.getHeaderElem=function(a){switch(a){case "left":return U;case "right":return M}return aa};
a.getRowElems=function(a){switch(a){case "left":return Da?Da.find("tr"):null;case "right":return Ea?Ea.find("tr"):null}return da?da.find("tr"):null};var mc=function(b,c,d,e){var h=a.currentList.length;0<h&&(b.shiftKey?n.isEqual(c[a.options.rowFields.id],a.currentList[0][a.options.rowFields.id])||Ub(b,d,e):n.isEqual(c[a.options.rowFields.id],a.currentList[h-1][a.options.rowFields.id])||Vb(b,d,e))},Vb=function(b,c,e){b.preventDefault();focusDelayTime=0;var m=c,h=D+ba-2,h=h<a.currentList.length-1?h:
a.currentList.length-1;m>=h&&J&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(p[0].clientHeight/4)}),focusDelayTime=1);if(m=a.getNextRow(m)){c=a.getRowCurrentIndex(m);c>h&&J&&(a.ensureVisible(m,"bottom"),focusDelayTime=100);a.rowSelection(m,b.shiftKey,b.ctrlKey);var f=d(function(){a.updateFocus(c,e);d.cancel(f)},focusDelayTime)}},Ub=function(b,c,e){b.preventDefault();focusDelayTime=0;var m=D,m=0<m?m:0;c==m&&J&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-Math.floor(p[0].clientHeight/
4)}),focusDelayTime=1);var h=a.getPrevRow(c);if(h){c=a.getRowCurrentIndex(h);c<m&&J&&(a.ensureVisible(h,"bottom"),focusDelayTime=100);a.rowSelection(h,b.shiftKey,b.ctrlKey);var f=d(function(){a.updateFocus(c,e);d.cancel(f)},focusDelayTime)}},sc=function(b,c,e,m){b.preventDefault();if((void 0===m||0<=m&&m==a.options.expandColIndex)&&!a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,!0),a.updateFocus(e,m);else if(0<=m){focusDelayTime=0;var h=m+1;b=a.columnList.length-
1;h===b&&(focusDelayTime=1);if(0<=h&&h<=b)var f=d(function(){a.updateFocus(e,h);d.cancel(f)},focusDelayTime)}},rc=function(b,c,e,m){b.preventDefault();if((void 0===m||0<=m&&m==a.options.expandColIndex)&&a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,!1),a.updateFocus(e,m);else if(0<=m){focusDelayTime=0;var h=1<m?m-1:0;if(0<=h)var f=d(function(){a.updateFocus(e,h);d.cancel(f)},focusDelayTime)}},nc=function(b,c,e){b.preventDefault();var m=c-ba,m=0<m?
m:0;if(m!==c){focusDelayTime=1;var h=a.getPrevRow(m+1);if(h){a.scrollTo(h);a.rowSelection(h,b.shiftKey,b.ctrlKey);g.$apply();var f=d(function(){a.updateFocus(a.getRowCurrentIndex(h),e);d.cancel(f)},focusDelayTime)}}},oc=function(b,c,e){b.preventDefault();var m=c+ba;a.options.showHeader&&m--;a.options.showFooter&&m--;m=m<a.currentList.length-1?m:a.currentList.length-1;if(m!==c){focusDelayTime=1;var h=a.getNextRow(m-1);if(h){a.scrollTo(h,"bottom");a.rowSelection(h,b.shiftKey,b.ctrlKey);g.$apply();var f=
d(function(){a.updateFocus(a.getRowCurrentIndex(h),e);d.cancel(f)},focusDelayTime)}}},pc=function(b,c,e){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:N.y});var m=a.getLastRow();if(m){a.rowSelection(m,b.shiftKey,b.ctrlKey);var h=d(function(){a.updateFocus(a.getRowCurrentIndex(m),e);d.cancel(h)},1)}},qc=function(b,c,e){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var m=a.getFirstRow();if(m){a.rowSelection(m,b.shiftKey,b.ctrlKey);var h=d(function(){a.updateFocus(a.getRowCurrentIndex(m),
e);d.cancel(h)},1)}},Tb=function(b,c){if(b&&0!=b[a.options.cellFields.allowEdit]){var d=a.getColumnById(b[a.options.cellFields.cid]);!d&&0<=c&&c<a.columnList.length&&(d=a.columnList[c]);if(d){var e=b[a.options.cellFields.value];if((d=d[a.options.columnFields.editorSettings])&&1==d.threeState)switch(n.isString(e)||(e="unchecked"),e){case "checked":e="unchecked";break;case "indeterminate":e="checked";break;default:e="indeterminate"}else e=n.isBoolean(e)?!e:!0;b[a.options.cellFields.value]=e;g.$apply()}}},
da=null,V=angular.element('<div class="iui-treegrid-block iui-treegrid-block-top"></div>'),aa=null,qa=angular.element('<div class="iui-treegrid-block iui-treegrid-block-left"></div>'),O=0,Na=0,U=null,ha=null,Da=null,ka=angular.element('<div class="iui-treegrid-block iui-treegrid-block-right"></div>'),ya=0,Oa=0,M=null,T=null,Ea=null,W=angular.element('<div class="iui-treegrid-block iui-treegrid-block-bottom"></div>'),pa=null,D=0,z=null,x=null,E=100,S=0,ba=0,Fa=0,lb=0,B=0,K=0,la=0,zb=!1,ja=!1,mb=9,
nb=9,Ab=0,Ga=0,Pa=0,ob=1,Bb=0,Cb=0,Ha=0,bb=0,Db=1,P=null,Q=null,H=!1,J=!1;this.scrollMousePos=null;var N={x:0,y:0},Ua=[];g.verScrollVisibility=!1;g.$watch("verScrollVisibility",function(b,c){b!=c&&a.updateCurrentLayout()});a.getColumnWidth=function(b){var c=100;b&&b[a.options.columnFields.width]&&(c=b[a.options.columnFields.width],n.isPercent(c)?(b=p[0].clientWidth-2*a.columnList.length,J&&G&&(b-=G[0].offsetWidth),c=Math.floor(parseInt(c,10)/100*b)):n.isString&&(c=parseInt(c,10)));return c};a.updateViewSize=
function(){var b=d(function(){la=0;var c=p[0].clientWidth;J&&G&&(c-=G[0].offsetWidth);H=!1;if(0<a.columnList.length){var e=a.getHeaderElem();if(e&&(e=e.find("td"))&&0<e.length)for(var f=0;f<e.length;f++){var h=angular.element(e[f]);la+=h[0].offsetWidth}a.isThereLeftFixedColumns&&(U?O=U[0].offsetWidth:ha&&(O=ha[0].offsetWidth),la+=O);a.isThereRightFixedColumns&&(M?ya=M[0].offsetWidth:T&&(ya=T[0].offsetWidth),la+=ya);la>c&&(w.unbind("mousedown"),p.append(w),w.bind("mousedown",function(b){a.removeDropDownList();
a.closeFilterWindow();a.closeEditor();b=n.getClientMousePos(b,this);var c=Math.floor(p[0].clientWidth);P&&(b.x<P[0].offsetLeft?a.setScrollPos({x:a.scrollPos.x-c,y:a.scrollPos.y}):b.x>P[0].offsetLeft+P[0].offsetWidth&&a.setScrollPos({x:a.scrollPos.x+c,y:a.scrollPos.y}))}),P=angular.element(w.children().eq(0)),H=!0,P.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();1===b.which&&(C.scrollMousePos=a.getMousePos(b),zb=!0);b.stopPropagation()}))}J=!1;g.verScrollVisibility=
!1;0<a.currentList.length&&(c=p[0].clientHeight-(B+K),H&&w&&(c-=w[0].offsetHeight),E=0<S?Math.floor(c/S)+1:0<B?Math.floor(c/B):100,E<a.currentList.length+1&&(G.unbind("mousedown"),p.append(G),G.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b=n.getClientMousePos(b,this);var c=Math.floor(p[0].clientHeight);Q&&(b.y<Q[0].offsetTop?(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-c}),xb(!1,c)):b.y>Q[0].offsetTop+Q[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,
y:a.scrollPos.y+c}),xb(!0,c)))}),Q=angular.element(G.children().eq(0)),J=!0,g.verScrollVisibility=!0,Q.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();1===b.which&&(C.scrollMousePos=a.getMousePos(b),ja=!0);b.stopPropagation()})));H||(w.unbind("mousedown"),w.remove(),N.x=0);J||(G.unbind("mousedown"),G.remove(),N.y=0);H&&J?p.append(ta):ta.remove();d.cancel(b);!H&&0<a.scrollPos.x&&a.setScrollPos({x:0,y:a.scrollPos.y});!J&&0<a.scrollPos.y&&a.setScrollPos({x:a.scrollPos.x,
y:0})},1)};a.updateScrollView=function(){Xb()};var Xb=function(){var b=d(function(){Fa=p[0].offsetWidth-2;lb=p[0].offsetHeight-2;H&&(lb-=w[0].offsetHeight);J&&(Fa-=G[0].offsetWidth);X.css("width",Fa+"px");X.css("height",lb+"px");H&&(w.css("left","0px"),w.css("bottom","0px"),w.css("width",Fa-2+"px"));J&&(G.css("top","0px"),G.css("right","0px"),G.css("height",lb-2+"px"));H&&J&&(ta.css("left","auto"),ta.css("right","0px"));var c=d(function(){H&&Fa<la&&(Ga=2,Pa=w[0].clientWidth-4,Ab=0,Pa>Ga&&(Ab=Pa-Ga),
mb=Math.floor(Ab*Fa/la),9>mb&&(mb=9),P.css("width",mb+"px"),N.x=la-Fa,ob=N.x/(Ab-mb-2));var b=a.currentList.length+1;J&&0<a.currentList.length&&E<b&&(Ha=2,bb=G[0].clientHeight-4,Bb=0,bb>Ha&&(Bb=bb-Ha),nb=Math.floor(Bb*E/b),9>nb&&(nb=9),Q.css("height",nb+"px"),Db=(b-E+1)/(Bb-nb-2),N.y=Math.floor((b-E+1)*S),0>N.y&&(N.y=0),0==D?Q.css("top",Ha+"px"):D+E-1==a.currentList.length&&Q.css("top",bb-Q[0].offsetHeight+"px"));a.isThereLeftFixedColumns&&(U?O=U[0].offsetWidth:ha&&(O=ha[0].offsetWidth),Na=p[0].clientHeight-
B-K,H&&(Na-=w[0].offsetHeight),qa.css("top",B+"px"),qa.css("width",O+"px"),qa.css("height",Na+"px"),aa&&aa.css("left",O+"px"),da&&da.css("left",O+"px"),pa&&pa.css("left",O+"px"));a.isThereRightFixedColumns&&(M?ya=M[0].offsetWidth:T&&(ya=T[0].offsetWidth),Oa=p[0].clientHeight-B-K,H&&(Oa-=w[0].offsetHeight),b=0,J&&(b=G[0].offsetWidth),M&&M.css("right",b+"px"),ka.css("top",B+"px"),ka.css("right",b+"px"),ka.css("width",ya+"px"),ka.css("height",Oa+"px"),T&&T.css("right",b+"px"));H&&w?W.css("bottom",w[0].offsetHeight+
"px"):W.css("bottom",0);d.cancel(c)},1);d.cancel(b)},5)};a.updateColumnWidth=function(){if(a.options.fillSpace){for(var b=0,c=0;c<a.columnList.length;c++)b+=a.getColumnWidth(a.columnList[c])+4;if(b<p[0].clientWidth){for(var b=(p[0].clientWidth-b)/a.columnList.length,d=0,c=0;c<a.columnList.length;c++)d=a.getColumnWidth(a.columnList[c])+b,a.columnList[c][a.options.columnFields.width]=d;return!0}}return!1};g.onCellValueChanging=function(b,c,d){var e=c+D,h=a.getCell(e,d);if(h&&0==h[a.options.cellFields.allowEdit])return!1;
var h=!0,f=a.getColumnObject(d),g="label",k=null;f&&(g=f[a.options.columnFields.editorType],k=f[a.options.columnFields.editorSettings]);f=null;switch(g){case "checkbox":f=k&&1==k.threeState?b.checkState:b.checked;h=a.callCellValueChanging(a.getRowObject(e),a.getCellObject(e,d),f);break;case "combobox":h=a.callCellValueChanging(a.getRowObject(c),a.getCellObject(c,d),b.item)}return h};g.onCellValueChanged=function(b,c,d){var e=c+D,h=a.getColumnObject(d),f="label",k=null;h&&(f=h[a.options.columnFields.editorType],
k=h[a.options.columnFields.editorSettings]);h=null;switch(f){case "checkbox":h=k&&1==k.threeState?b.checkState:b.checked;a.callCellValueChanged(a.getRowObject(e),a.getCellObject(e,d),h);break;case "combobox":if(e=a.getCell(c,d))e[a.options.cellFields.value]=b.item,g.$apply();a.removeDropDownList(!0);a.updateFocus(c,d);a.callCellValueChanged(a.getRowObject(c),a.getCellObject(c,d),b.item)}};g.onEditorClick=function(b,c,d){c+=D;var e=a.getColumnObject(d),h="label";e&&(h=e[a.options.columnFields.editorType]);
switch(h){case "checkbox":a.callCellClick(b,a.getRowObject(c),a.getCellObject(c,d),a.getMousePos(b))}};a.setDefaultCellValue=function(b,c,d){if(void 0==b[a.options.cellFields.value]){var e=void 0;switch(c){case "checkbox":e=d&&1==d.threeState?"unchecked":!1;break;case "image":e=""}void 0!=e&&(b[a.options.cellFields.value]=e)}};var cb=function(b,c){c=void 0==c?"none":c;for(var d='<table cellpadding="0" cellspacing="0" style="position:absolute;',d=(b?d+'bottom:0;">':d+'top:0;">')+"<tr>",e="none",h=
0;h<a.columnList.length;h++)e=a.columnList[h][a.options.columnFields.fixed],e=void 0==e?"none":e,e==c&&(b?(d+='<td iui-class="{{data['+h+'].style.footer.general}}" data-index="'+h+'" data-element="column-footer">',d+='<div iui-class="{{data['+h+'].style.footer.cell}}" data-element="column-footer-cell"'):(d+='<td iui-class="{{data['+h+'].style.header.general}}" data-index="'+h+'" data-element="column-header">',d+='<div iui-class="{{data['+h+'].style.header.cell}}" data-element="column-header-cell"'),
d+=' iui-contextmenu menu-items="data['+h+"].column."+a.options.columnFields.contextMenu+'"',b?(d+=' iui-style="overflow:hidden;width:{{data['+h+"].width}}px;text-align:{{data["+h+"].footerAlignment}};",d=h==a.options.expandColIndex?d+("padding-left:{{data["+h+'].indent}}px;">'):d+'">',a.columnList[h][a.options.columnFields.footerContent]?d+=a.columnList[h][a.options.columnFields.footerContent]:a.columnList[h][a.options.columnFields.footerTemplate]?d+='<div ng-include="'+a.columnList[h][a.options.columnFields.footerTemplate]+
'" style="margin:0;padding:0"></div>':(d+='<span iui-class="{{data['+h+'].style.footer.content}}" data-element="cell-content">',d+="{{data["+h+"].column."+a.options.columnFields.footerText+"}}</span>")):(d+=' iui-style="overflow:hidden;width:{{data['+h+"].width}}px;text-align:{{data["+h+"].headerAlignment}};",d=h==a.options.expandColIndex?d+("padding-left:{{data["+h+'].indent}}px;">'):d+'">',d+='<span iui-class="{{data['+h+'].style.header.content}}" data-element="cell-content">',d+="{{data["+h+"].column."+
a.options.columnFields.headerText+"}}</span>",d+='<span iui-class="{{data['+h+'].style.filtering}}" data-index="'+h+'" data-element="filter-button" ng-show="data['+h+'].showFiltering"></span>',d+='<span iui-class="{{data['+h+'].style.sorting}}" data-index="'+h+'" data-element="sort-button" ng-show="data['+h+'].showSorting"></span>'),d+="</div>",d+="</td>");return d+="</tr></table>"},Eb=function(b,c,d){c=void 0==c?"none":c;var e="none",h='<tr iui-class="{{data['+b+'].style}}" data-index="{{data['+
b+'].index}}" tabindex="{{data['+b+'].tabindex}}"';d&&(h+=' style="position:absolute;top:-9999px"');h+=">";for(d=0;d<a.columnList.length;d++)if(e=a.columnList[d][a.options.columnFields.fixed],e=void 0==e?"none":e,e==c){var h=h+('<td iui-class="{{data['+b+"].cells["+d+'].style.cell}}" data-element="cell" data-index="'+d+'" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+"].cells["+d+'].tabindex}}">'),h=h+('<div ng-show="data['+b+'].visible"'),h=h+(' iui-class="{{data['+b+"].cells["+d+'].style.content}}" data-element="cell-content"'),
h=h+(' iui-contextmenu menu-items="data['+b+"].row."+a.options.rowFields.contextMenu+'" menu-update="{{data['+b+'].updateContextMenu}}"'),h=h+(' iui-style="width:{{data['+b+"].cells["+d+"].width}}px;text-align:{{data["+b+"].cells["+d+"].alignment}};"),e=h=d==a.options.expandColIndex?h+("padding-left:{{data["+b+"].cells["+d+'].indent}}px;">'):h+'">',h=b,f=d,g="";f===a.options.expandColIndex&&(g+='<span iui-class="{{data['+h+'].expandBox}}" data-element="expandbox"></span>',g+='<span iui-class="{{data['+
h+'].icon}}" data-element="icon" ng-show="data['+h+'].iconVisible"></span>');var k=a.columnList[f][a.options.columnFields.editorSettings];switch(a.columnList[f][a.options.columnFields.editorType]){case "checkbox":g+='<iui-checkbox name="cb-'+n.getUniqueId(4)+'"';k&&1==k.threeState?(g+=' check-state="data['+h+"].cells["+f+"].related."+a.options.cellFields.value+'"',g+=' checkstate-changing="onCellValueChanging(e, '+h+", "+f+')"',g+=' checkstate-changed="onCellValueChanged(e, '+h+", "+f+')"',g+=' three-state="true"'):
(g+=' checked="data['+h+"].cells["+f+"].related."+a.options.cellFields.value+'"',g+=' checked-changing="onCellValueChanging(e, '+h+", "+f+')"',g+=' checked-changed="onCellValueChanged(e, '+h+", "+f+')"');g+=' click="onEditorClick(e, '+h+", "+f+')"';k&&k.style&&(g+=' control-style="data['+h+"].cells["+f+'].editorStyle"');g+=' enabled="data['+h+"].cells["+f+"].related."+a.options.cellFields.enabled+'"';g+=' style="vertical-align:middle;" iui-show="{{data['+h+"].cells["+f+'].visible}}"></iui-checkbox>';
break;case "combobox":g+='<span iui-class="{{data['+h+"].cells["+f+'].style.label}}" data-element="content">';g+="{{data["+h+"].cells["+f+"].related."+a.options.cellFields.value+".text}}";g+="</span>";break;case "image":g+='<img data-element="image" style="vertical-align:middle" src="{{data['+h+"].cells["+f+"].related."+a.options.cellFields.value+'}}"  iui-show="{{data['+h+"].cells["+f+'].visible}}" show-default="true" />';break;default:g+='<span iui-class="{{data['+h+"].cells["+f+'].style.label}}" data-element="content">',
g+="{{data["+h+"].cells["+f+"].related."+a.options.cellFields.text+"}}",g+="</span>"}h=e+g;h+="</div>";h+="</td>"}return h+"</tr>"},Pc=function(){S=0;if(0<a.currentList.length&&x){var b="none";a.isThereLeftFixedColumns&&(b="left");a.isThereRightFixedColumns&&(b="right");var b=Eb(0,b,!0),e=c(b)(x);p.append(e);var f=d(function(){S=e[0].offsetHeight;e.remove();d.cancel(f)},1)}},Qc=function(){if(1<a.updateStatus)F("end");else var b=d(function(){if(0<a.columnList.length&&1==a.updateStatus){z=g.$new();
z.data=uc();a.refreshColumns();z.$apply();for(var e="",e=K=B=0;e<a.columnList.length;e++){var f={columnID:void 0!=a.columnList[e][a.options.columnFields.id]?a.columnList[e][a.options.columnFields.id]:e,avgItemHeight:0};switch(a.columnList[e][a.options.columnFields.editorType]){case "combobox":Ic(a.columnList[e].editorSettings,e,f);Ua.push(f);break;default:Ua.push(f)}}a.options.showHeader&&(p.append(V),ra&&V.css("opacity",ea.opacity),e=cb(),aa=angular.element(c(e)(z)),V.append(aa),a.isThereLeftFixedColumns&&
(e=cb(!1,"left"),U=c(e)(z),V.append(U),U.css("z-index","2"),U.addClass("iui-treegrid-column-header-left")),a.isThereRightFixedColumns&&(e=cb(!1,"right"),M=c(e)(z),V.append(M),M.css("right","0"),M.css("z-index","1"),M.addClass("iui-treegrid-column-header-right")));a.options.showFooter&&(p.append(W),ra&&W.css("opacity",ea.opacity),e=cb(!0),pa=c(e)(z),W.append(pa),a.isThereLeftFixedColumns&&(e=cb(!0,"left"),ha=c(e)(z),W.append(ha),ha.css("z-index","2"),ha.addClass("iui-treegrid-column-footer-left")),
a.isThereRightFixedColumns&&(e=cb(!0,"right"),T=c(e)(z),W.append(T),T.css("right","0"),T.css("z-index","1"),T.addClass("iui-treegrid-column-footer-right")));for(var m=null,e=null,h=f=-1,k=0;k<a.columnList.length;k++)if(e=m=null,a.columnList[k][a.options.columnFields.headerContent]?(m=a.columnList[k][a.options.columnFields.headerContent],f=1):a.columnList[k][a.options.columnFields.headerTemplate]&&(m=a.columnList[k][a.options.columnFields.headerTemplate],f=2),a.columnList[k][a.options.columnFields.footerContent]?
(e=a.columnList[k][a.options.columnFields.footerContent],h=1):a.columnList[k][a.options.columnFields.footerTemplate]&&(e=a.columnList[k][a.options.columnFields.footerTemplate],h=2),m||e){var l=a.getElemFromColumn(a.columnList[k],a.columnList[k][a.options.columnFields.fixed]);if(l){if(m){var n=a.getChildElement(l,"column-header-cell");if(n)switch(n.empty(),f){case 1:n.append(c(m)(g.$parent));break;case 2:m='<div ng-include="'+m+'"',a.columnList[k][a.options.columnFields.headerTemplateModel]&&(m+=' onload="'+
a.columnList[k][a.options.columnFields.headerTemplateModel]+'"'),m+=' style="margin:0;padding:0"></div>',n.append(c(m)(g.$parent))}}if(e&&(n=a.getChildElement(l,"column-footer-cell")))switch(n.empty(),h){case 1:n.append(c(e)(g.$parent));break;case 2:m='<div ng-include="'+e+'"',a.columnList[k][a.options.columnFields.footerTemplateModel]&&(m+=' onload="'+a.columnList[k][a.options.columnFields.footerTemplateModel]+'"'),m+=' style="margin:0;padding:0"></div>',n.append(c(m)(g.$parent))}}}ma(40);F("rows")}else ma(70),
F("scroll");d.cancel(b)},1)},Rc=function(){if(1<a.updateStatus)F("end");else var b=d(function(){if(0<a.columnList.length){var e=0;if(a.options.showHeader&&aa){B=aa[0].offsetHeight;a.isThereLeftFixedColumns&&U?B=U[0].offsetHeight:a.isThereRightFixedColumns&&M&&(B=M[0].offsetHeight);var f=0,m=aa.find("td");if(m&&0<m.length)for(var h=0;h<m.length;h++)var k=angular.element(m[h]),f=f+k[0].offsetWidth;f>p[0].clientWidth&&(f=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),
f.css("bottom","-9999px"),p.append(f),e=f[0].offsetHeight,f.remove());V.css("width",p[0].clientWidth+"px");V.css("height",B+"px");a.isThereLeftFixedColumns&&(O=U[0].offsetWidth,Na=p[0].clientHeight-B-K,aa.css("left",O+"px"));a.isThereRightFixedColumns&&(ya=M[0].offsetWidth,Oa=p[0].clientHeight-B-K)}a.options.showFooter&&(K=pa[0].offsetHeight,a.isThereLeftFixedColumns&&ha?K=ha[0].offsetHeight:a.isThereRightFixedColumns&&T&&(K=T[0].offsetHeight),W.css("width",p[0].clientWidth+"px"),W.css("height",K+
"px"),a.isThereLeftFixedColumns&&(O=ha[0].offsetWidth,Na=p[0].clientHeight-B-K,pa.css("left",O+"px")),a.isThereRightFixedColumns&&(ya=T[0].offsetWidth,Oa=p[0].clientHeight-B-K));vc();if(0<a.currentList.length){x=g.$new();x.data=wc();a.refreshRows();x.$apply();Pc();var l=d(function(){kc();da&&da.remove();Da&&Da.remove();Ea&&Ea.remove();var b=p[0].clientHeight-(B+K)-e;E=0<S?Math.floor(b/S)+1:0<B?Math.floor(b/B)+1:100;ba=0;for(var b="",q=0;q<E;q++)b+=Eb(q),ba++;if(0<ba){da=angular.element('<table cellpadding="0" cellspacing="0" style="position:absolute;top:'+
B+'px;"></table>');da.append(c(b)(x));X.append(da);if(a.isThereLeftFixedColumns){da.css("left",O+"px");b="";for(q=ba=0;q<E;q++)b+=Eb(q,"left"),ba++;0<ba&&(Da=angular.element('<table class="iui-treegrid-rows-left" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),Da.append(c(b)(x)),qa.append(Da),p.append(qa),ra&&qa.css("opacity",ea.opacity))}if(a.isThereRightFixedColumns){b="";for(q=ba=0;q<E;q++)b+=Eb(q,"right"),ba++;0<ba&&(Ea=angular.element('<table class="iui-treegrid-rows-right" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),
Ea.append(c(b)(x)),ka.append(Ea),p.append(ka),ra&&ka.css("opacity",ea.opacity))}}ma(70);F("scroll");d.cancel(l)},1)}else ma(70),F("scroll")}else ma(70),F("scroll");d.cancel(b)},1)},F=function(b){if(db&&!Qa)switch(b){case "start":1<a.updateStatus?F("end"):(a.updateColumnList(),a.updateCurrentList(),ma(10),F("init"));break;case "init":1<a.updateStatus?F("end"):(Ua.length=0,gc(),zb||ja||Xb(),X.empty(),da=null,V.empty(),V.remove(),aa=null,W.empty(),W.remove(),pa=null,qa.empty(),qa.remove(),Na=O=0,Da=
U=null,ka.empty(),ka.remove(),Oa=ya=0,Ea=M=null,z&&z.$destroy(),x&&x.$destroy(),ma(20),F("columns"));break;case "columns":Qc();break;case "rows":V?V.find("td").length<a.columnList.length?d(function(){F(b)},1):Rc():d(function(){F(b)},1);break;case "scroll":1<a.updateStatus?F("end"):(a.updateViewSize(),a.updateViewSize(),a.updateScrollView(),ma(80,"complete"),F("complete"));break;case "complete":1<a.updateStatus?F("end"):(ma(90),F("events"));break;case "events":1<a.updateStatus||(a.allowEvents=!0,a.options.showHeader&&
(aa&&Sb(aa),a.isThereLeftFixedColumns&&U&&Sb(U),a.isThereRightFixedColumns&&M&&Sb(M)),0<a.currentList.length&&Nc(),ma(100));F("end");break;case "end":switch(ea.type){case "circular":xc();eb=0;Ia=!0;1==a.updateStatus&&a.callLoadComplete();break;case "linear":yc(!1);break;default:eb=0,Ia=!0,1==a.updateStatus&&a.callLoadComplete()}a.updateActive=!1;a.updateStatus--;0<a.updateStatus?(db=a.updateActive=!0,1==a.updateStatus?F("start"):F("end")):a.callUpdateComplete()}else d(function(){F(b)},1)},Fb=0,Ra=
0,Gb=0,zc=0,Qa=!1,Hb=!1,ea={type:"none",speed:"normal",opacity:0},Yb=null,ra=!1,Ia=!1,yc=function(b){var c=l(function(){b?Ra++:Ra--;Gb=(p[0].clientHeight-Ra)/2+2;pb.css("height",Ra+"px");za.css("top",Gb+"px");b&&5<=Ra?(ra=!0,ma(0),Ia=Qa=!1,l.cancel(c)):!b&&0>=Ra&&(za&&za.remove(),eb=0,Ia=!0,a.callLoadComplete(),l.cancel(c))},20)},xc=function(){Yb&&l.cancel(Yb);sa&&sa.remove()};a.beginLoad=function(a){if(!Qa)switch(Qa=!0,ea=a?{type:void 0!=a.type?a.type:"none",speed:void 0!=a.speed?a.speed:"normal",
opacity:void 0!=a.opacity?a.opacity:0}:{type:"none",speed:"normal",opacity:0},Zb(ea.opacity),ea.type){case "circular":xc();p.append(sa);sa.css("top",(p[0].clientHeight-sa[0].offsetHeight)/2+"px");sa.css("left",(p[0].clientWidth-sa[0].offsetWidth)/2+"px");ra=!0;Ia=Qa=!1;var b=0,c=3;switch(ea.speed){case "veryfast":c=7;break;case "fast":c=5;break;case "slow":c=2;break;case "veryslow":c=1}Yb=l(function(){b+=c;360<b&&(b=0);var a="rotate("+b+"deg)";sa.css("-ms-transform",a);sa.css("-webkit-transform",
a);sa.css("transform",a)},1);break;case "linear":pb.css("width","0px");pb.css("height","0px");p.append(za);eb=0;Fb=Math.floor(.5*p[0].clientWidth);Ra=0;Gb=p[0].clientHeight/2+2;zc=(p[0].clientWidth-Fb)/2;za.css("width",Fb+"px");za.css("top",Gb+"px");za.css("left",zc+"px");za.css("opacity","1");yc(!0);break;default:ra=!0,Ia=Qa=!1}};a.endLoad=function(b){if(!Hb)if(Hb=!0,b=a.options.loadRows.indexOf(b),0<=b&&a.options.loadRows.splice(b,1),ra){ra=!1;var c=3,d=ea.opacity,e=l(function(){Ia&&(10<c||1<=d?
(Zb(1),Hb=Qa=Ia=!1,ea={type:"none",speed:"normal"},l.cancel(e)):(d+=c/10,Zb(d),c+=3))},1)}else Hb=!1};var Zb=function(a){V&&V.css("opacity",a);qa&&qa.css("opacity",a);X&&X.css("opacity",a);ka&&ka.css("opacity",a);W&&W.css("opacity",a);w&&w.css("opacity",a);G&&G.css("opacity",a);ta&&ta.css("opacity",a)},pb=angular.element('<div style="background:#0080c0;width:0px;height:5px;"></div>'),za=angular.element('<div style="background:#e5e5e5;position:absolute;top:10px;left:10px;z-index:999"></div>');za.append(pb);
var eb=0,db=!1,sa=angular.element('<div class="iui-load-circular"></div>'),ma=function(a){if(ra&&"linear"==ea.type){db=!1;var b=Math.floor(Fb*a/100),c=eb;a=10;switch(ea.speed){case "veryfast":a=2;break;case "fast":a=5;break;case "slow":a=15;break;case "veryslow":a=20}var d=b>c?Math.floor((b-c)/a):1,d=0<d?d:1,e=l(function(){c+=d;pb.css("width",c+"px");c>=b&&(eb=b,db=!0,l.cancel(e))},1)}else db=!0};a.updateStatus=0;a.updateActive=!1;a.updateLayout=function(b){b=!0;for(var c=p.parent();"body"!=c[0].tagName.toLowerCase();){if("none"==
getComputedStyle(c[0]).display){b=!1;break}c=c.parent()}b&&a.allowUpdate&&(a.updateStatus++,a.updateActive||(a.updateActive=!0,a.allowEvents=!1,p.removeClass("iui-treegrid-block-rtl"),a.options.rtl&&p.addClass("iui-treegrid-block-rtl"),X.removeClass("iui-treegrid-block-shift-left iui-treegrid-block-rtl"),X.addClass(Sa()),S=0,E=100,K=B=0,db=!0,F("start")))};a.updateCurrentLayout=function(){if(a.allowUpdate)if(0==a.currentList.length)a.updateLayout();else{a.updateCurrentList();a.updateView();var b=
d(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();d.cancel(b)},1)}};var Ac=function(b,c){var d="left";return d=c?b[a.options.columnFields.footerAlignment]:b[a.options.columnFields.headerAlignment]},Sc=function(b,c){var d=Ac(b),e=Ac(b,!0),h=a.isFilteringAllowed(b),f=a.isSortingAllowed()&&b==a.sortColumn,g=a.getColumnWidth(b),g=0<=g?g:0,k=$b(b);g<k.min&&(g=k.min);g>k.max&&(g=k.max);return{headerAlignment:d,footerAlignment:e,index:c,indent:0,column:b,showFiltering:h,showSorting:f,
style:{header:{},footer:{}},width:g}},Tc=function(b,c,d){for(var e=[],h=0;h<a.columnList.length;h++){var f,g=h;if(d){var k=a.columnList[h][a.options.columnFields.id];k&&(g=a.getCellIndexById(a.currentList[c][a.options.rowFields.cells],h,k))}f=g;if(d)a:{if(0<=f&&(g=a.currentList[c][a.options.rowFields.cells],f<g.length)){g=g[f];break a}g={}}else g={};var k=a.columnList[h][a.options.columnFields.contentAlignment]?a.columnList[h][a.options.columnFields.contentAlignment]:"left",l;l=(l=a.columnList[h][a.options.columnFields.editorSettings])&&
l.style?l.style:null;var p;if(d){if(p=0,h==a.options.expandColIndex){p=c;var u=0,v=a.columnList[a.options.expandColIndex],x=a.getColumnWidth(v),w=x-a.indentList[p],w=0<=w?w:0,u={top:0,right:0,bottom:0,left:0};(v=a.getElemFromColumn(v,v[a.options.columnFields.fixed]))&&(v=a.getChildElement(v,"column-header-cell"))&&(u=n.getPadding(v[0]));u=u.left+a.indentList[p];0==w&&(u=x);p=u}}else p=0;x=f;d?(w=c,u=h,w=1==a.options.allowFocus&&1==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[w])&&0<=u?a.getTabIndex().toString()+
(w+1).toString()+u.toString():""):w="";if(d)a:{if(0<=f&&(u=a.currentList[c][a.options.rowFields.cells],f<u.length)){u=u[f][a.options.cellFields.text];break a}u=""}else u="";if(d)a:{if(0<=f&&(v=a.currentList[c][a.options.rowFields.cells],f<v.length)){v=v[f][a.options.cellFields.value];break a}v=null}else v=null;f=d?0<=f?!0:!1:!1;var y;if(d){y=c;var B=h,A=a.columnList[B],z=a.getColumnWidth(A),A=$b(A);z<A.min&&(z=A.min);z>A.max&&(z=A.max);B==a.options.expandColIndex&&(z-=a.indentList[y]);y=z=0<=z?z:
0}else y=0;e.push({related:g,alignment:k,editorStyle:l,indent:p,index:x,style:{},tabindex:w,text:u,value:v,visible:f,width:y})}if(d){h="";g=a.defaultStyle.row.expandBox.general;b[a.options.rowFields.style]&&b[a.options.rowFields.style].expandBox&&b[a.options.rowFields.style].expandBox.general!=g?g+=" "+b[a.options.rowFields.style].expandBox.general:a.options.controlStyle.row.expandBox.general!=g&&(g+=" "+a.options.controlStyle.row.expandBox.general);k=a.getCurrentRowStyle(b);k=a.getExpandBoxStyle(k.expandBox);
if(a.isThereChildRows||b&&b[a.options.rowFields.hasChildren])h=g;b&&(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(0<=a.options.loadRows.indexOf(b)?h+=" "+k.animated:(h=b[a.options.rowFields.hasChildren]&&void 0===b[a.options.rowFields.expanded]?h+(" "+k.expanded):!1!==b[a.options.rowFields.expanded]?h+(" "+k.collapsed):h+(" "+k.expanded),!0===a.options.rtl&&(h+="-rtl"),a.isRowEnabled(b)||(h+="-disabled")))}else h=
"";g=d?a.isRowEnabled(b)&&a.isDragAllowed(b):!1;d?(k="",b.icon?k=b.icon:a.options.rowIcon&&(k=a.options.rowIcon)):k="";l=d?0!=a.options.showIcons&&(b.icon||a.options.rowIcon):!1;f=d?1==a.options.allowFocus&&0==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[c])?a.getTabIndex().toString()+(c+1).toString():"":"";return{cells:e,expandBox:h,draggable:g,icon:k,iconVisible:l,index:c,row:d?b:{},style:{},tabindex:f,updateContextMenu:d?null!=b[a.options.rowFields.contextMenu]:!1,visible:d}},uc=function(){for(var b=
[],c=0;c<a.columnList.length;c++)b.push(Sc(a.columnList[c],c));return b},wc=function(){for(var b=[],c=D;c<D+E;c++)b.push(Tc(a.currentList[c],c,c<a.currentList.length));return b},vc=function(){for(var b=0;b<a.columnList.length;b++)if(a.isFilteringAllowed(a.columnList[b])){var c=a.getElemFromColumn(a.columnList[b],a.columnList[b][a.options.columnFields.fixed]);c&&(c=a.getChildElement(c,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&(c.css("top",(B-parseInt(getComputedStyle(c[0]).height,
10))/2-1+"px"),c.css("right","2px"))}a.isSortingAllowed()&&a.sortColumn&&(b=a.getElemFromColumn(a.sortColumn,a.sortColumn[a.options.columnFields.fixed]))&&(c=a.getChildElement(b,"column-header-cell"))&&(c=a.getContentElement(c,"sort-button"))&&(c.css("top",(B-parseInt(getComputedStyle(c[0]).height,10))/2-1+"px"),a.isFilteringAllowed(a.sortColumn)?c.css("right","22px"):c.css("right","2px"))};a.getRowScope=function(){return x};var Cc=function(){z&&x&&(a.allowEvents=!1,Bc(!1),0<a.columnList.length&&
(z.data=uc(),x.data=wc(),a.options.selectedRow&&!a.isRowEnabled(a.options.selectedRow)&&(a.options.selectedRow[a.options.rowFields.selected]=!1,a.options.selectedRow=null,a.updateSelectionList()),a.refresh(null,null,!1),z.$apply(),x.$apply(),vc(),a.allowEvents=!0))};a.updateView=function(a){if(a)Cc();else var b=d(function(){Cc();d.cancel(b)},1)};var Dc=function(b,c,d){var e={cell:"",content:"",general:"",label:""},f="";switch(c){case "column":d?(f=a.defaultStyle.column.footer.normal,a.options.controlStyle.column.footer.normal!=
f&&(f+=" "+a.options.controlStyle.column.footer.normal),e.general=f,e.cell="iui-treegrid-column-footer-cell",f=a.defaultStyle.column.footer.content,a.options.controlStyle.column.footer.content!=f&&(f+=" "+a.options.controlStyle.column.footer.content)):(f=a.defaultStyle.column.header.normal,a.options.controlStyle.column.header.normal!=f&&(f+=" "+a.options.controlStyle.column.header.normal),e.general=f,e.cell="iui-treegrid-column-header-cell",f=a.defaultStyle.column.header.content,a.options.controlStyle.column.header.content!=
f&&(f+=" "+a.options.controlStyle.column.header.content));e.content=f;break;case "row":f=a.defaultStyle.row.general.normal;a.options.controlStyle.row.general.normal!=f&&(f+=" "+a.options.controlStyle.row.general.normal);e.general=f;break;case "cell":f=a.defaultStyle.row.cell.normal;a.options.controlStyle.row.cell.normal!=f&&(f+=" "+a.options.controlStyle.row.cell.normal);switch(a.options.gridLines){case "none":f=b==D+E-1||b==a.currentList.length-1?f+" iui-treegrid-lines-horizontal":f+" iui-treegrid-lines-none";
break;case "horizontal":f+=" iui-treegrid-lines-horizontal";break;case "vertical":f=b==D+E-1||b==a.currentList.length-1?f+" iui-treegrid-lines-both":f+" iui-treegrid-lines-vertical";break;default:f+=" iui-treegrid-lines-both"}e.general=f;f=a.defaultStyle.row.cell.content;a.options.controlStyle.row.cell.content!=f&&(f+=" "+a.options.controlStyle.row.cell.content);e.content=f;e.label=a.getDefaultCellLabelClass()}return e},Ib=function(b,c,d,e){var f=a.getObjState(b);d=Dc(d,b.type,e);switch(b.type){case "column":e?
(c=a.getCurrentColumnStyle(b,"footer",f),c!=a.options.controlStyle.column.footer.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,"footer","content"),b!=a.options.controlStyle.column.footer.content&&(d.content+=" "+b)):(c=a.getCurrentColumnStyle(b,"header",f),c!=a.options.controlStyle.column.header.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,"header","content"),b!=a.options.controlStyle.column.header.content&&(d.content+=" "+b));break;case "row":b=a.getCurrentRowStyle(b,f);b!=a.options.controlStyle.row.general.normal&&
(d.general+=" "+b);break;case "cell":e=a.getCurrentCellStyle(c,b,f),e!=a.options.controlStyle.row.cell.normal&&(d.general+=" "+e),b=a.getCurrentCellStyle(c,b,"content"),b!=a.options.controlStyle.row.cell.content&&(d.content+=" "+b)}return d},ac=function(a,b,c){x.data[a].cells[b].style.cell=c.general;x.data[a].cells[b].style.content=c.content;x.data[a].cells[b].style.label=c.label},Ec=function(b){if(x&&(b-=D,0<=b&&b<x.data.length&&x.data[b].visible)){x.data[b].style=a.defaultStyle.row.general.normal;
for(var c=0;c<a.columnList.length;c++)x.data[b].cells[c].style.cell=a.defaultStyle.row.cell.normal+" iui-treegrid-cell-empty"}};a.refreshColumns=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b],null,!1)};a.refreshRows=function(){for(var b=D;b<D+E;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):Ec(b)};a.refresh=function(b,c,d){if(b)switch(b.type){case "column":if(z&&(c=a.getColumnCurrentIndex(b),0<=c&&c<z.data.length)){1==a.options.showHeader&&(z.data[c].style.header=
Ib(b));1==a.options.showFooter&&(z.data[c].style.footer=Ib(b,null,-1,!0));var e=z.data[c].style,f="";if(a.isFilteringAllowed(b)){var g=a.getObjState(b),f="iui-filtering";"selected"==g?f+=" iui-filtering-selected":"hovered"==g&&(f+=" iui-filtering-hovered")}e.filtering=f;c=z.data[c].style;e="";a.isSortingAllowed()&&b==a.sortColumn&&(b=a.getObjState(b),"ascending"==a.options.sorting?(e="iui-sort-ascending","selected"==b?e+=" iui-sort-ascending-selected":"hovered"==b&&(e+=" iui-sort-ascending-hovered")):
(e="iui-sort-descending","selected"==b?e+=" iui-sort-descending-selected":"hovered"==b&&(e+=" iui-sort-descending-hovered")));c.sorting=e;void 0==d&&z&&z.$apply()}break;case "row":if(x&&(c=a.getRowCurrentIndex(b),e=c-D,0<=e&&e<x.data.length&&x.data[e].visible)){x.data[e].style=Ib(b).general;f=Dc(c,"cell");for(g=0;g<a.columnList.length&&g<x.data[e].cells.length;g++){var k=x.data[e].cells[g].index;if(0<=k){var l=b[a.options.rowFields.cells];k<l.length?(k=Ib(l[k],b,c),ac(e,g,k)):ac(e,g,f)}else ac(e,
g,f)}void 0==d&&x&&x.$apply()}}else{for(g=0;g<a.columnList.length;g++)a.refresh(a.columnList[g],null,!1);for(b=D;b<D+E;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):Ec(b);1==d&&x&&x.$apply()}};a.moveColumn=function(b,c){if(b&&0!=a.callColumnPosChanging(b)){var d=a.columnList[0];0<=a.options.expandColIndex&&a.options.expandColIndex<a.columnList.length&&(d=a.columnList[a.options.expandColIndex]);var e=a.getColumnCurrentIndex(b),f=a.getColumnRealIndex(e),g=-1;switch(c){case "first":g=
0;break;case "left":(e=Qb(e-1,b[a.options.columnFields.fixed],!0))&&(g=a.getColumnRealIndex(a.getColumnCurrentIndex(e)));break;case "right":(e=Rb(e+1,b[a.options.columnFields.fixed],!0))&&(g=a.getColumnRealIndex(a.getColumnCurrentIndex(e)));break;case "last":g=a.columnList.length-1}0<=g&&g<a.columnList.length&&f!=g&&(f<g?"first"!=c&&"left"!=c||g--:f>g&&("last"!=c&&"right"!=c||g++),a.columnsObj.moveObject(f,g),a.updateColumnList(),d=a.getColumnCurrentIndex(d),d!=a.options.expandColIndex?(a.options.expandColIndex=
d,a.updateLayout()):a.updateView(),a.callColumnPosChanged(I,a.hoverColumn))}};a.moveRow=function(b,c,d,e){if(b){a.allowUpdate=!1;var f=-1;switch(d){case "first":f=0;break;case "at":f=e}if(Array.isArray(b)){e=[];for(var g=0;g<b.length;g++){for(var k=!1,l=a.getParent(b[g]);l;){if(0<=b.indexOf(l)){k=!0;break}l=a.getParent(l)}k||e.push(b[g])}if(0<e.length)if(b=a.getObjCurrentIndex(e[0]),g=a.getObjCurrentIndex(e[e.length-1]),b<=g)for(g=0;g<e.length;g++)bc(e[g],c,f,d);else for(g=e.length-1;0<=g;g--)bc(e[g],
c,f,d)}else bc(b,c,f,d);a.allowUpdate=!0;a.updateCurrentLayout();a.callChange()}};var bc=function(b,c,d,e){a.rowsObj.removeAt(b,-1,null,a.objIsRemoved)&&("first"==e||"last"==e||"at"==e?a.rowsObj.insertAt(b,d,c,a.rowIsAdded):"before"==e?a.rowsObj.insertByRef(b,c,!1,a.rowIsAdded):"after"==e&&a.rowsObj.insertByRef(b,c,!0,a.rowIsAdded))},wa="none",L=!1,Jb=-1,wa="none",Kb=0,Lb=0;g.$watch(function(){return p[0].offsetWidth},function(b,c){100==E?a.updateLayout():b!=c&&(V&&V.css("width",p[0].clientWidth+
"px"),W&&W.css("width",p[0].clientWidth+"px"),a.updateCurrentLayout())});g.$watch(function(){return p[0].offsetHeight},function(b,c){b!=c&&a.updateLayout()});a.isColumnWithFixedWidth=function(b){var c=a.columnList;return c&&0<=b&&b<c.length?c[b][a.options.columnFields.fixedWidth]?c[b][a.options.columnFields.fixedWidth]:!1:!1};a.setColumnResizingParams=function(b,c,d){0<=b&&b<a.columnList.length&&(Jb=b,wa=c,Lb=d,Kb=a.getColumnWidth(a.columnList[b]))};var Fc=function(b){return b&&0!=b[a.options.columnFields.visible]?
!0:!1},Qb=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f="none";0<=b;b--)if(!d||d&&Fc(a.columnList[b]))if(f=a.columnList[b][a.options.columnFields.fixed],f=void 0==f?"none":f,f==c){e=a.columnList[b];break}return e},Rb=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f="none";b<a.columnList.length;b++)if(!d||d&&Fc(a.columnList[b]))if(f=a.columnList[b][a.options.columnFields.fixed],f=void 0==f?"none":f,f==c){e=a.columnList[b];break}return e},lc=function(b,c){if(0<=b&&b<a.columnList.length){var d=
a.columnList[b];if(d)switch(columnFixedType=d[a.options.columnFields.fixed],c){case "left":if("right"!=columnFixedType){if(!Qb(b-1,d[a.options.columnFields.fixed]))return!1}else if(!columnFixedType||"none"==columnFixedType)return 0<b;break;case "right":if("right"==columnFixedType&&!Rb(b+1,d[a.options.columnFields.fixed]))return!1}}return!0};a.resizeColumn=function(b,c,d){0>c&&(c=0);var e=null;if(e=a.getHeaderElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,1,d);if(e=a.getRowElems(d)){var f=
{top:0,right:0,bottom:0,left:0},g=a.getElemFromColumn(a.columnList[b],a.columnList[b][a.options.columnFields.fixed]);g&&(g=a.getChildElement(g,"column-header-cell"))&&(f=n.getPadding(g[0]));for(g=0;g<e.length;g++)angular.element(e[g]),a.resizeColumnCells(angular.element(e[g]),b,c,0,d,!0,f)}if(e=a.getFooterElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,2,d);0<=b&&b<a.columnList.length&&a.callColumnSizeChanged(a.columnList[b])};a.resizeColumnCells=function(b,c,d,e,f,g,k){if(b){var l=
-1;g&&(l=a.getRowCurrentIndex(a.getRowFromElem(b)));b=b=0;0<=l&&(b=a.indentList[l]);g=null;switch(e){case 1:g=a.getElemFromColumnCell(c,f);break;case 2:g=a.getElemFromColumnCell(c,f,!0);break;default:g=a.getElemFromCell(l,c,f)}g&&0<g.children().length&&(e=g.children().eq(0))&&(b=k?k.left+b:b,k=d,0<=l&&c==a.options.expandColIndex&&(k-=b),k=0<=k?k:0,e.css("width",k+"px"),c==a.options.expandColIndex&&(0==k?e.css("padding-left",d+"px"):e.css("padding-left",b+"px")))}};angular.element(f).bind("dragover",
function(a){Ya()});var Z=angular.element('<div class="iui-treegrid-column-reorder-mark"><span></span></div>'),oa=angular.element('<div class="iui-treegrid-column-reorder-tooltip"><span></span></div>'),hc=function(b){var c="initial";ia&&I&&(!a.hoverColumn||I==a.hoverColumn||a.hoverColumn&&0==a.hoverColumn.allowDrop||a.hoverColumn&&I[a.options.columnFields.fixed]!=a.hoverColumn[a.options.columnFields.fixed])&&(c="not-allowed",b&&oa&&oa.css("display","none"));p.css("cursor",c);document.body.style.cursor=
c},$b=function(b){return b?{min:n.isFieldAvailable(b[a.options.columnFields.minWidth],0),max:n.isFieldAvailable(b[a.options.columnFields.maxWidth],9999999)}:{min:0,max:9999999}};angular.element(f).bind("mousemove",function(b){if(0===b.button&&0<=Jb&&"none"!=wa){var c=a.getMousePos(b),d=Jb,e=a.columnList;if(0<=d&&d<e.length){var f=Kb+c.x-Lb;"right"==e[d][a.options.columnFields.fixed]&&(f=Kb-(c.x-Lb));f=0<=f?f:0;c=$b(e[d]);f>=c.min&&f<=c.max&&(e[d][a.options.columnFields.width]=f,a.resizeColumn(d,f,
e[d][a.options.columnFields.fixed]),a.updateViewSize(),Xb())}}zb?1===b.which&&(P[0].getBoundingClientRect(),b=a.getMousePos(b),C.scrollMousePos||(C.scrollMousePos=b),d=P[0].offsetLeft+(b.x-C.scrollMousePos.x),d<Ga?d=Ga:d+P[0].offsetWidth>Pa&&(d=Pa-P[0].offsetWidth),P.css("left",d+"px"),C.scrollMousePos=b,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.x=!1!==a.options.rtl?parseInt((Pa-P[0].offsetLeft-P[0].offsetWidth)*ob,10):parseInt((P[0].offsetLeft-Ga)*ob,10),Gc(),(cc(a.scrollPos)||
a.scrollPos.x!=a.prevScrollPos.x)&&a.callScrollPosChanged()):ja&&1===b.which&&(Q[0].getBoundingClientRect(),b=a.getMousePos(b),C.scrollMousePos||(C.scrollMousePos=b),d=Q[0].offsetTop+(b.y-C.scrollMousePos.y),d<Ha?d=Ha:d+Q[0].offsetHeight>bb&&(d=bb-Q[0].offsetHeight),Q.css("top",d+"px"),C.scrollMousePos=b,Cb=d-Ha,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.y=Math.floor(Cb*Db*S),(cc(a.scrollPos)||a.scrollPos.y!=a.prevScrollPos.y)&&a.callScrollPosChanged(),newIndex=0<S?Math.floor(a.scrollPos.y/
S):0,newIndex+E-1>a.currentList.length&&(newIndex=a.currentList.length-E+1,newIndex+=5),0>newIndex&&(newIndex=0),newIndex!==D&&(D=newIndex,a.updateView(!0)))});angular.element(f).bind("mousedown",function(b){a.removeDropDownList();a.closeEditor(e);a.closeFilterWindow();fb()});angular.element(f).bind("mouseup",function(b){hc(!0);oa&&oa.remove();ia=!1;Jb=-1;wa="none";Lb=Kb=0;L=!1;p.css("cursor","default");a.dropMark();ja&&a.updateView();Ya();C.scrollMousePos=null;ja=zb=!1;p.css("cursor","default");
document.body.style.cursor="default"});var dc=!1,Ja=0,Mb=null,ec=.5;a.isScrollBarVisible=function(a){switch(a){case "horizontal":return H;case "vertical":return J}return H&&J};a.prevScrollPos={x:0,y:0};a.scrollPos={x:0,y:0};a.getMaxScrollPos=function(){return N};a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b,c){if(b){var d=!0;0>b.x&&(b.x=0,d=!1);b.x>N.x&&(b.x=N.x,d=!1);0>b.y&&(b.y=0,d=!1);b.y>N.y&&(b.y=N.y,d=!1);a.scrollPos=b;Cb=Math.floor(a.scrollPos.y/(S*Db));var e=0,f=
Ha+Cb,e=!1!==a.options.rtl?Math.floor(a.scrollPos.x/ob)-(Pa-P[0].offsetWidth-Ga):Math.floor(a.scrollPos.x/ob)+Ga;H&&P&&P.css("left",e+"px");J&&Q&&Q.css("top",f+"px");Gc();Bc(!0,c);d&&a.callScrollPosChanged()}};var cc=function(a){return 0<a.x&&a.x<N.x||0<a.y&&a.y<N.y},xb=function(b,c,d){dc||(a.updateFocus(),Ja=0,dc=!0,Mb=l(function(){var d=c,e=a.getScrollPos();d||(0===Ja&&(Ja=5),Ja+=5+Db,ec+=.5,d=Ja+=Math.floor(ec));e.y=b?e.y+d:e.y-d;a.setScrollPos(e);(0>=e.y||a.getScrollPos().y<e.y)&&Ya()},d?d:100))},
Ya=function(){Mb&&(l.cancel(Mb),Mb=null);dc=!1;Ja=0};a.cancelScrollTimer=function(){Ya()};a.scrollTo=function(b,c){if(b){var d=a.getRowCurrentIndex(b);if(a.isRowIndexInRange(d)){var e=0,e=d;switch(c){case "center":e=Math.floor(ba/2)-1;e=d>e?d-e:0;break;case "bottom":e=ba-2,a.options.showHeader&&e--,a.options.showFooter&&e--,e=d>e?d-e:0}a.setScrollPos({x:a.scrollPos.x,y:e*S})}}};var Gc=function(){var b=a.scrollPos.x;0>b&&(b=0);b>N.x&&(b=N.x);b*=-1;aa&&aa.css("left",b+O+"px");pa&&pa.css("left",b+O+
"px");da&&da.css("left",b+O+"px")},Bc=function(b,c){if(!(0==b&&0>=S)){newIndex=0<S?Math.floor(a.scrollPos.y/S):0;a.scrollPos.y==N.y&&newIndex--;if(a.currentList.length>=E&&newIndex+E-1>a.currentList.length){newIndex=a.currentList.length-E+1;var d=a.getRowElems();d||(d=a.getRowElems("left"));d||(d=a.getRowElems("right"));d&&0<d.length&&(d=angular.element(d[d.length-1]),d[0].offsetTop+d[0].offsetHeight>p[0].clientHeight-(B+K)&&newIndex++)}0>newIndex&&(newIndex=0);newIndex!=D&&(D=newIndex,0!=b&&a.updateView(c))}};
p.bind("scroll",function(a){p[0].scrollTop=0;p[0].scrollLeft=0});p.bind("mousewheel",function(b){b.preventDefault();if(J){document.activeElement&&document.activeElement.blur();a.removeDropDownList();a.closeEditor(e);a.closeFilterWindow();fb();var c=a.hoverRow;a.hoverRow=null;a.refresh(c);c=0;b.wheelDelta?c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,b.originalEvent.wheelDelta||-b.originalEvent.detail)));b=Math.floor(p[0].clientHeight/4);a.prevScrollPos=
{x:a.scrollPos.x,y:a.scrollPos.y};a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+b*c*-1},!0);cc(a.scrollPos)||a.scrollPos.y==a.prevScrollPos.y||a.callScrollPosChanged()}});var qb={x:0,y:0},Ka={x:0,y:0};p.bind("touchstart",function(b){b.preventDefault();(b=a.getTouchData(b))&&0<b.length&&(qb={x:b[0].pageX,y:b[0].pageY})});p.bind("touchend",function(b){(b=a.getTouchData(b))&&0<b.length&&(Ka={x:b[0].pageX,y:b[0].pageY});var c=Ka.x-qb.x,d=Ka.y-qb.y;(20<Math.abs(c)||20<Math.abs(d))&&document.activeElement&&
document.activeElement.blur();var e=!1,f=!1,g=qb,k=l(function(){var b=a.scrollPos;-20>c?(g.x-=10,g.x>Ka.x?b.x+=10:(b.x-=c,e=!0)):20<c?(g.x+=10,g.x<Ka.x?b.x-=10:(b.x-=c,e=!0)):e=!0;-20>d?(g.y-=10,g.y>Ka.y?b.y+=10:(b.y-=d,f=!0)):20<d?(g.y+=10,g.y<Ka.y?b.y-=10:(b.y-=d,f=!0)):f=!0;a.setScrollPos(b);e&&f&&l.cancel(k)},10);qb=Ka});C=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){var b;b="<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>";
b+=a[1]+a[4]+a[2]+a[0]+a[3];return b+="</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(C.tpar));this.tmp=300;this.twp=200*tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",p[0].scrollTop+"px"),this.$tw.css("left",p[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),
this.$tw.css("top",p[0].scrollTop+"px"),this.$tw.css("left",p[0].scrollLeft+"px"))};this.s1t=function(a){this.trlTime=d(function(){C.trActive||(C.trCount=0,C.trActive=!0,C.trId=l(function(){C.animTr()},1E3))},a)};this.s2t=function(){this.trId&&(l.clear(this.trId),this.trId=null);this.trlTime&&(d.cancel(this.trlTime),this.trlTime=null);this.trActive=!1;this.$tw.remove()};p.append(this.$tw);this.s1t(this.twp);angular.isDefined(g.options)?a.updateOptions(g.options):(0==g.allowAnimation&&(a.options.allowAnimation=
g.allowAnimation),0==g.allowCellFocus&&(a.options.allowCellFocus=g.allowCellFocus),1==g.allowColumnReorder&&(a.options.allowColumnReorder=g.allowColumnReorder),angular.isDefined(g.controlStyle)&&a.updateControlStyle(g.controlStyle),1==g.allowDrag&&(a.options.allowDrag=g.allowDrag),0==g.allowDrop&&(a.options.allowDrop=g.allowDrop),1==g.allowFilter&&(a.options.allowFilter=g.allowFilter),0==g.allowFocus&&(a.options.allowFocus=g.allowFocus),0==g.autoExpand&&(a.options.autoExpand=g.autoExpand),angular.isDefined(g.animationSpeed)&&
200!==g.animationSpeed&&(a.options.animationSpeed=g.animationSpeed),angular.isDefined(g.editorSettings)&&a.updateEditorSettings(g.editorSettings),angular.isDefined(g.expandingColumnIndex)&&(a.options.expandColIndex=g.expandingColumnIndex),angular.isDefined(g.fields)&&(a.updateDataFields(g.fields),a.updateData()),1==g.fillSpace&&(a.options.fillSpace=g.fillSpace),angular.isDefined(g.gridLines)&&(a.options.gridLines=g.gridLines),1==g.hoverSelection&&(a.options.hoverSelection=g.hoverSelection),angular.isDefined(g.indent)&&
(a.options.indent=g.indent),angular.isDefined(g.rowIcon)&&(a.options.rowIcon=g.rowIcon),angular.isDefined(g.labelEdit)&&(a.options.labelEdit=g.labelEdit),1==g.rtl&&(a.options.rtl=g.rtl),angular.isDefined(g.selectedIndex)&&(a.options.selectedIndex=g.selectedIndex),angular.isDefined(g.selectedRow)&&(a.options.selectedRow=g.selectedRow),angular.isDefined(g.selectionMode)&&(a.options.selectionMode=g.selectionMode),0==g.showFooter&&(a.options.showFooter=g.showFooter),0==g.showHeader&&(a.options.showHeader=
g.showHeader),0==g.showIcons&&(a.options.showIcons=g.showIcons),angular.isDefined(g.sorting)&&(a.options.sorting=g.sorting));a.updateLayout()}}}]);